<!doctype html><html><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"><title>SqExcel Add-in</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script src="https://cdn.tailwindcss.com"></script><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script><script defer="defer" src="commands.js"></script><script defer="defer" src="functions.js"></script><link href="styles.css" rel="stylesheet"></head><body class="bg-gray-50 text-gray-800"><header class="flex items-center gap-3 p-4 border-b border-gray-200 bg-white"><img width="48" height="48" src="assets/logo-filled.png" alt="SqExcel" title="SqExcel" class="rounded"/><div><h1 class="text-xl font-semibold leading-tight">SqExcel</h1><p class="text-sm text-gray-500">Excel add-in for fast, reliable Seeq data access</p></div></header><section id="sideload-msg" class="p-4"><h2 class="text-base">Please <a class="text-indigo-600 underline" target="_blank" href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a> your add-in to see app body.</h2></section><main id="app-body" style="display:none" class="p-4 flex flex-col gap-4 w-full"><div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm w-full"><h3 class="text-lg font-medium mb-3">Seeq Authentication</h3><div class="grid grid-cols-1 gap-3"><label class="block"><span class="text-sm text-gray-600">Seeq Server URL</span> <input type="url" id="seeq-url" placeholder="https://your-server.seeq.site" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"/></label> <label class="block"><span class="text-sm text-gray-600">Access Key</span> <input id="seeq-access-key" placeholder="Your Seeq access key" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"/></label> <label class="block"><span class="text-sm text-gray-600">Password</span> <input type="password" id="seeq-password" placeholder="Your Seeq password" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"/></label><div class="flex items-center gap-2 pt-1"><button id="authenticate" class="px-3 py-1.5 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Authenticate</button> <button id="logout" class="px-3 py-1.5 text-sm bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200" style="display:none">Logout</button></div></div><div id="auth-status" class="mt-2 text-sm"></div></div><div id="diagnostics" class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm w-full"><h3 class="text-lg font-medium mb-2">Getting Started</h3><ol class="list-decimal list-inside text-sm space-y-1 mb-3"><li><span class="font-medium">Create Access Key:</span> Seeq → Profile → Access Keys → Create.</li><li><span class="font-medium">Authenticate:</span> Enter URL, Key, Password → Authenticate.</li><li><span class="font-medium">Use in Excel:</span> Paste formulas below.</li></ol><h4 class="text-sm font-semibold mb-2">Quick Functions</h4><ul class="text-sm space-y-1"><li class="flex items-start gap-2"><code class="bg-gray-100 rounded px-1.5 py-0.5">=SqExcel.SEARCH_SENSORS(A1:C1)</code><span class="text-gray-600">verify sensors; see unit/description</span></li><li class="flex items-start gap-2"><code class="bg-gray-100 rounded px-1.5 py-0.5">=SqExcel.PULL(sensorNames, startTime, endTime, "points", 1000)</code><span class="text-gray-600">pull N points</span></li><li class="flex items-start gap-2"><code class="bg-gray-100 rounded px-1.5 py-0.5">=SqExcel.PULL(sensorNames, startTime, endTime, "grid", "15min")</code><span class="text-gray-600">pull on 15‑minute intervals</span></li><li class="flex items-start gap-2"><code class="bg-gray-100 rounded px-1.5 py-0.5">=SqExcel.CURRENT(sensorName)</code><span class="text-gray-600">current value</span></li><li class="flex items-start gap-2"><code class="bg-gray-100 rounded px-1.5 py-0.5">=SqExcel.AVERAGE(sensorName, startTime, endTime)</code><span class="text-gray-600">average over range</span></li></ul><p class="text-xs text-gray-500 mt-3">Tip: Timestamp column returns Excel serials. Format as Date to see readable times.</p><h4 class="text-sm font-semibold mt-3 mb-1">Troubleshooting</h4><ul class="text-sm text-gray-700 space-y-1"><li><span class="font-medium">#NAME?</span> Ensure add-in is loaded.</li><li><span class="font-medium">Auth errors:</span> Verify URL/Key/Password.</li><li><span class="font-medium">No data:</span> Check sensor names and time range.</li></ul></div><div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm w-full" style="display:none"><h3 class="text-lg font-medium mb-3">Sensor Search</h3><div class="grid grid-cols-1 gap-3"><label class="block"><span class="text-sm text-gray-600">Sensor Names (comma-separated)</span> <input id="sensor-names" placeholder="Sensor1, Sensor2, Sensor3" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"/></label> <label class="block"><span class="text-sm text-gray-600">Start Time</span> <input type="datetime-local" id="start-time" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"/></label> <label class="block"><span class="text-sm text-gray-600">End Time</span> <input type="datetime-local" id="end-time" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"/></label> <label class="block"><span class="text-sm text-gray-600">Data Mode</span> <select id="data-mode" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"><option value="points">Points (number of data points)</option><option value="grid">Grid (time interval)</option></select></label> <label class="block"><span class="text-sm text-gray-600" id="mode-value-label">Number of Points</span> <input type="number" id="mode-value" placeholder="1000" value="1000" class="mt-1 w-full rounded-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm"/></label><div class="flex items-center gap-2 pt-1"><button id="search-sensors" class="px-3 py-1.5 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Search Sensors</button> <button id="pull-data" class="px-3 py-1.5 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700">Pull Data</button></div><div id="search-results" class="text-sm"></div><div id="data-results" class="text-sm"></div></div></div><p class="text-xs text-gray-500"><label id="item-subject"></label></p></main></body></html>