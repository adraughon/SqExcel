/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,r,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function i(t,o,s,a){var i=o&&o.prototype instanceof u?o:u,l=Object.create(i.prototype);return n(l,"_invoke",function(t,n,o){var s,a,i,u=0,l=o||[],d=!1,h={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return s=t,a=0,i=e,h.n=n,c}};function f(t,n){for(a=t,i=n,r=0;!d&&u&&!o&&r<l.length;r++){var o,s=l[r],f=h.p,p=s[2];t>3?(o=p===n)&&(i=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=f&&((o=t<2&&f<s[1])?(a=0,h.v=n,h.n=s[1]):f<p&&(o=t<3||s[0]>n||n>p)&&(s[4]=t,s[5]=n,h.n=p,a=0))}if(o||t>1)return c;throw d=!0,n}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,p),a=l,i=p;(r=a<2?e:i)||!d;){s||(a?a<3?(a>1&&(h.n=-1),f(a,i)):h.n=i:h.v=i);try{if(u=2,s){if(a||(o="next"),r=s[o]){if(!(r=r.call(s,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=s.return)&&r.call(s),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);s=e}else if((r=(d=h.n<0)?i:t.call(n,h))!==c)break}catch(t){s=e,a=1,i=t}finally{u=1}}return{value:r,done:d}}}(t,s,a),!0),l}var c={};function u(){}function l(){}function d(){}r=Object.getPrototypeOf;var h=[][s]?r(r([][s]())):(n(r={},s,function(){return this}),r),f=d.prototype=u.prototype=Object.create(h);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,n(e,a,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=d,n(f,"constructor",d),n(d,"constructor",l),l.displayName="GeneratorFunction",n(d,a,"GeneratorFunction"),n(f),n(f,a,"Generator"),n(f,s,function(){return this}),n(f,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:p}})()}function n(e,t,r,o){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}n=function(e,t,r,o){function a(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?s?s(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},n(e,t,r,o)}function r(e,t,n,r,o,s,a){try{var i=e[s](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,s){var a=e.apply(t,n);function i(e){r(a,o,s,i,c,"next",e)}function c(e){r(a,o,s,i,c,"throw",e)}i(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function a(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var c=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"authToken",null),a(this,"credentials",null),a(this,"diagnosticLog",[]),this.seeqServerUrl=t.replace(/\/$/,""),this.proxyUrl="https://sqexcel.up.railway.app",this.logDiagnostic("CLIENT_INIT","SeeqAPIClient initialized with proxy: ".concat(this.proxyUrl,", Seeq server: ").concat(this.seeqServerUrl))},n=[{key:"logDiagnostic",value:function(e,t,n){var r={timestamp:(new Date).toISOString(),category:e,message:t,data:n,userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()};this.diagnosticLog.push(r),console.log("[".concat(e,"] ").concat(t),n||"")}},{key:"detectAppDomain",value:function(){try{return"undefined"!=typeof Office&&Office.context?"Office.js - ".concat(Office.context.host||"Unknown Host"):"https:"===window.location.protocol?"HTTPS Web Context":"http:"===window.location.protocol?"HTTP Web Context":"file:"===window.location.protocol?"File Protocol Context":"Unknown Context - ".concat(window.location.protocol)}catch(e){return"Error detecting context: ".concat(e)}}},{key:"getNetworkInfo",value:function(){try{var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return{online:navigator.onLine,connectionType:(null==e?void 0:e.effectiveType)||"unknown",downlink:(null==e?void 0:e.downlink)||"unknown",rtt:(null==e?void 0:e.rtt)||"unknown"}}catch(e){return{online:navigator.onLine,error:e.toString()}}}},{key:"getDiagnostics",value:function(){return{clientInfo:{proxyUrl:this.proxyUrl,seeqServerUrl:this.seeqServerUrl,isAuthenticated:!!this.authToken,diagnosticLogCount:this.diagnosticLog.length},environment:{userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo(),timestamp:(new Date).toISOString()},recentLogs:this.diagnosticLog.slice(-20)}}},{key:"clearDiagnostics",value:function(){this.diagnosticLog=[],this.logDiagnostic("DIAGNOSTICS_CLEARED","Diagnostic logs cleared")}},{key:"testConnection",value:(l=o(t().m(function e(){var n,r,o,s,a,i,c,u,l,d,h;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=Date.now(),r="".concat(this.proxyUrl,"/api/seeq/test-connection"),this.logDiagnostic("PROXY_CONNECTION_TEST_START","Testing connection to proxy server: ".concat(this.proxyUrl),{url:r,seeqServerUrl:this.seeqServerUrl,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()}),e.p=1,e.n=2,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl})});case 2:if(o=e.v,s=Date.now()-n,a={},o.headers.forEach(function(e,t){a[t]=e}),this.logDiagnostic("PROXY_CONNECTION_RESPONSE","Proxy connection test response received",{status:o.status,statusText:o.statusText,requestTime:s,allHeaders:a,url:o.url}),!o.ok){e.n=4;break}return e.n=3,o.json();case 3:return i=e.v,this.logDiagnostic("PROXY_CONNECTION_SUCCESS","Proxy connection test successful",i),e.a(2,{success:!0,message:i.message||"Proxy server is reachable and can connect to Seeq",status_code:o.status,diagnostics:{response_headers:a,request_timing:s,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 4:return e.n=5,o.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_CONNECTION_FAILED","Proxy connection test failed with status: ".concat(o.status),{status:o.status,statusText:o.statusText,headers:a,errorData:c}),e.a(2,{success:!1,message:c.message||"Proxy server responded with status code: ".concat(o.status),status_code:o.status,error:c.error||"HTTP ".concat(o.status),diagnostics:{response_headers:a,request_timing:s,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 6:e.n=8;break;case 7:return e.p=7,h=e.v,u=Date.now()-n,this.logDiagnostic("PROXY_CONNECTION_ERROR","Proxy connection test error",{error:h.message,errorName:h.name,errorStack:h.stack,requestTime:u,url:r}),l="Proxy connection test failed",d="Unknown","TypeError"===h.name&&h.message.includes("fetch")?(l="Cannot connect to proxy server - connection refused. This may be due to network issues.",d="ConnectionError"):"AbortError"===h.name?(l="Connection timeout - the proxy server took too long to respond.",d="Timeout"):h.message.includes("Failed to fetch")?(l="Connection failed - unable to reach the proxy server. This may be due to network problems.",d="FetchError"):(l="Proxy connection test failed: ".concat(h.message),d=h.message),e.a(2,{success:!1,message:l,error:d,diagnostics:{request_timing:u,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(){return l.apply(this,arguments)})},{key:"authenticate",value:(u=o(t().m(function e(n,r){var o,s,a,i,c,u,l,d,h,f=arguments;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return o=f.length>2&&void 0!==f[2]?f[2]:"Seeq",s=f.length>3&&void 0!==f[3]&&f[3],e.p=1,this.credentials={accessKey:n,password:r,authProvider:o,ignoreSslErrors:s,seeq_url:this.seeqServerUrl},this.logDiagnostic("PROXY_AUTH_START","Attempting to authenticate through proxy: ".concat(this.proxyUrl),{seeqServerUrl:this.seeqServerUrl,accessKey:n,authProvider:o}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:n,password:r,auth_provider:o,ignore_ssl_errors:s})});case 2:if(a=e.v,this.logDiagnostic("PROXY_AUTH_RESPONSE","Proxy authentication response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=8;break}return e.n=3,a.json();case 3:return i=e.v,this.authToken=i.token||"authenticated",this.logDiagnostic("PROXY_AUTH_SUCCESS","Proxy authentication successful",{user:i.user,server_url:i.server_url}),e.p=4,e.n=5,this.storeCredentialsForExcel();case 5:e.n=7;break;case 6:e.p=6,d=e.v,console.warn("Failed to store credentials for Excel functions:",d);case 7:return e.a(2,{success:!0,message:i.message||"Successfully authenticated as ".concat(n),user:i.user||n,server_url:i.server_url||this.seeqServerUrl,token:this.authToken||void 0});case 8:return e.n=9,a.json().catch(function(){return{}});case 9:return c=e.v,this.logDiagnostic("PROXY_AUTH_FAILED","Proxy authentication failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Authentication failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status)});case 10:e.n=12;break;case 11:return e.p=11,h=e.v,this.logDiagnostic("PROXY_AUTH_ERROR","Proxy authentication error",{error:h.message,errorName:h.name}),u="Authentication failed",l="Unknown","TypeError"===h.name&&h.message.includes("fetch")?(u="Network error: Cannot connect to proxy server. Please check your internet connection.",l="NetworkError"):"AbortError"===h.name?(u="Request timeout: The authentication request took too long. Please try again.",l="TimeoutError"):h.message.includes("Failed to fetch")?(u="Connection failed: Unable to reach the proxy server. This may be due to network issues.",l="ConnectionError"):(u="Authentication failed: ".concat(h.message),l=h.name||"UnknownError"),e.a(2,{success:!1,message:u,error:l});case 12:return e.a(2)}},e,this,[[4,6],[1,11]])})),function(e,t){return u.apply(this,arguments)})},{key:"storeCredentialsForExcel",value:(c=o(t().m(function e(){var n,r;return t().w(function(e){for(;;)switch(e.n){case 0:if(this.credentials){e.n=1;break}throw new Error("No credentials available to store");case 1:return e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/credentials"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:this.seeqServerUrl,accessKey:this.credentials.accessKey,password:this.credentials.password,authProvider:this.credentials.authProvider,ignoreSslErrors:this.credentials.ignoreSslErrors,timestamp:(new Date).toISOString()})});case 2:if((n=e.v).ok){e.n=4;break}return e.n=3,n.json().catch(function(){return{}});case 3:throw r=e.v,new Error("Failed to store credentials: ".concat(r.error||n.statusText));case 4:return e.a(2)}},e,this)})),function(){return c.apply(this,arguments)})},{key:"searchSensors",value:function(){var e=o(t().m(function e(n){var r,o,s,a,i,c,u;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.authToken||this.credentials){e.n=1;break}return e.a(2,{success:!1,message:"Not authenticated. Please authenticate first.",error:"Authentication required",search_results:[],sensor_count:0});case 1:return e.p=1,this.logDiagnostic("PROXY_SEARCH_START","Searching for sensors through proxy",{sensorNames:n,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/search"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:n,username:null===(r=this.credentials)||void 0===r?void 0:r.accessKey,password:null===(o=this.credentials)||void 0===o?void 0:o.password,auth_provider:(null===(s=this.credentials)||void 0===s?void 0:s.authProvider)||"Seeq"})});case 2:if(a=e.v,this.logDiagnostic("PROXY_SEARCH_RESPONSE","Proxy search response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=4;break}return e.n=3,a.json();case 3:return i=e.v,this.logDiagnostic("PROXY_SEARCH_SUCCESS","Proxy search successful",{sensorCount:i.sensor_count,searchResults:i.search_results}),e.a(2,{success:!0,message:i.message||"Found ".concat(i.sensor_count," sensors"),search_results:i.search_results||[],sensor_count:i.sensor_count||0});case 4:return e.n=5,a.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_SEARCH_FAILED","Proxy search failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Search failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status),search_results:[],sensor_count:0});case 6:e.n=8;break;case 7:return e.p=7,u=e.v,this.logDiagnostic("PROXY_SEARCH_ERROR","Proxy search error",{error:u.message,errorName:u.name}),e.a(2,{success:!1,message:"Sensor search failed: ".concat(u.message),error:u.message,search_results:[],sensor_count:0});case 8:return e.a(2)}},e,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()},{key:"searchAndPullSensors",value:(i=o(t().m(function e(n,r,o){var s,a,i,c,u,l,d,h,f,p=arguments;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=p.length>3&&void 0!==p[3]?p[3]:"15min",e.p=1,this.logDiagnostic("PROXY_SEARCH_PULL_START","Searching and pulling sensor data through proxy",{sensorNames:n,startTime:r,endTime:o,grid:s,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/data"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:n,start_time:r,end_time:o,grid:s,username:null===(a=this.credentials)||void 0===a?void 0:a.accessKey,password:null===(i=this.credentials)||void 0===i?void 0:i.password,auth_provider:(null===(c=this.credentials)||void 0===c?void 0:c.authProvider)||"Seeq"})});case 2:if(u=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_RESPONSE","Proxy search and pull response received",{status:u.status,statusText:u.statusText}),!u.ok){e.n=4;break}return e.n=3,u.json();case 3:return d=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_SUCCESS","Proxy search and pull successful",{sensorCount:d.sensor_count,dataLength:(null===(l=d.data)||void 0===l?void 0:l.length)||0,dataColumns:d.data_columns}),e.a(2,{success:!0,message:d.message||"Successfully retrieved data for ".concat(d.sensor_count," sensors"),search_results:d.search_results||[],data:d.data||[],data_columns:d.data_columns||[],data_index:d.data_index||[],sensor_count:d.sensor_count||0,time_range:{start:r,end:o,grid:s}});case 4:return e.n=5,u.json().catch(function(){return{}});case 5:return h=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_FAILED","Proxy search and pull failed",{status:u.status,errorData:h}),e.a(2,{success:!1,message:h.message||"Search and pull failed with status ".concat(u.status),error:h.error||"HTTP ".concat(u.status),search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:r,end:o,grid:s}});case 6:e.n=8;break;case 7:return e.p=7,f=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_ERROR","Proxy search and pull error",{error:f.message,errorName:f.name}),e.a(2,{success:!1,message:"Search and pull operation failed: ".concat(f.message),error:f.message,search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:r,end:o,grid:s}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(e,t,n){return i.apply(this,arguments)})},{key:"getAuthStatus",value:function(){var e;return{isAuthenticated:!!this.authToken,user:null===(e=this.credentials)||void 0===e?void 0:e.accessKey}}},{key:"logout",value:(r=o(t().m(function e(){var n,r,o,s;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!this.authToken){e.n=2;break}return this.logDiagnostic("PROXY_LOGOUT_START","Logging out through proxy"),e.n=1,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:null===(n=this.credentials)||void 0===n?void 0:n.accessKey})});case 1:r=e.v,this.logDiagnostic("PROXY_LOGOUT_RESPONSE","Proxy logout response received",{status:r.status,statusText:r.statusText});case 2:return e.p=2,e.n=3,fetch("".concat(this.proxyUrl,"/api/seeq/credentials"),{method:"DELETE",headers:{"Content-Type":"application/json"}});case 3:e.n=5;break;case 4:e.p=4,o=e.v,console.warn("Failed to clear credentials from backend:",o);case 5:e.n=7;break;case 6:e.p=6,s=e.v,this.logDiagnostic("PROXY_LOGOUT_ERROR","Proxy logout error",{error:s.message});case 7:return e.p=7,this.authToken=null,this.credentials=null,e.f(7);case 8:return e.a(2)}},e,this,[[2,4],[0,6,7,8]])})),function(){return r.apply(this,arguments)})},{key:"getCredentials",value:function(){return this.credentials}},{key:"setCredentials",value:function(e){this.credentials=e}}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r,i,c,u,l}();function u(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function s(n,r,o,s){var c=r&&r.prototype instanceof i?r:i,u=Object.create(c.prototype);return l(u,"_invoke",function(n,r,o){var s,i,c,u=0,l=o||[],d=!1,h={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return s=t,i=0,c=e,h.n=n,a}};function f(n,r){for(i=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,s=l[t],f=h.p,p=s[2];n>3?(o=p===r)&&(c=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=f&&((o=n<2&&f<s[1])?(i=0,h.v=r,h.n=s[1]):f<p&&(o=n<3||s[0]>r||r>p)&&(s[4]=n,s[5]=r,h.n=p,i=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,p),i=l,c=p;(t=i<2?e:c)||!d;){s||(i?i<3?(i>1&&(h.n=-1),f(i,c)):h.n=c:h.v=c);try{if(u=2,s){if(i||(o="next"),t=s[o]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=s.return)&&t.call(s),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);s=e}else if((t=(d=h.n<0)?c:n.call(r,h))!==a)break}catch(t){s=e,i=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,s),!0),u}var a={};function i(){}function c(){}function d(){}t=Object.getPrototypeOf;var h=[][r]?t(t([][r]())):(l(t={},r,function(){return this}),t),f=d.prototype=i.prototype=Object.create(h);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=d,l(f,"constructor",d),l(d,"constructor",c),c.displayName="GeneratorFunction",l(d,o,"GeneratorFunction"),l(f),l(f,o,"Generator"),l(f,r,function(){return this}),l(f,"toString",function(){return"[object Generator]"}),(u=function(){return{w:s,m:p}})()}function l(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,n,r){function s(t,n){l(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(s("next",0),s("throw",1),s("return",2))},l(e,t,n,r)}function d(e,t,n,r,o,s,a){try{var i=e[s](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var s=e.apply(t,n);function a(e){d(s,r,o,a,i,"next",e)}function i(e){d(s,r,o,a,i,"throw",e)}a(void 0)})}}var f="Loading...",p=null;function g(){return v.apply(this,arguments)}function v(){return(v=h(u().m(function e(){var t,n,r;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Attempting to load version info..."),e.n=1,fetch("./version.json");case 1:if(t=e.v,console.log("Relative path response status:",t.status),t.ok){e.n=3;break}return console.log("Relative path failed, trying full URL..."),e.n=2,fetch("https://adraughon.github.io/SqExcel/version.json");case 2:t=e.v,console.log("Full URL response status:",t.status);case 3:if(!t.ok){e.n=5;break}return e.n=4,t.json();case 4:n=e.v,console.log("Version data loaded:",n),f="".concat(n.version," - ").concat(n.description),e.n=6;break;case 5:console.error("Failed to load version.json, status:",t.status),f="Version info unavailable";case 6:e.n=8;break;case 7:e.p=7,r=e.v,console.error("Failed to load version info:",r),f="Version info unavailable";case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function m(){var e=document.getElementById("authenticate"),t=document.getElementById("logout"),n=document.getElementById("search-sensors"),r=document.getElementById("pull-data");e&&(e.onclick=y),t&&(t.onclick=k),n&&(n.onclick=_),r&&(r.onclick=b),function(){var e=localStorage.getItem("seeq_credentials");if(e)try{var t=JSON.parse(e);document.getElementById("seeq-url").value=t.url||"",document.getElementById("seeq-access-key").value=t.accessKey||"",document.getElementById("seeq-password").value=t.password||"";var n=new Date(t.timestamp);((new Date).getTime()-n.getTime())/36e5<24?(O(!0),E("Using saved credentials","info"),t.url&&(p=new c(t.url))):localStorage.removeItem("seeq_credentials")}catch(e){console.error("Failed to load saved credentials:",e),localStorage.removeItem("seeq_credentials")}}(),console.log("SqExcel Add-in Version: ".concat(f)),E("Add-in Version: ".concat(f),"info")}function y(){return w.apply(this,arguments)}function w(){return(w=h(u().m(function e(){var t,n,r,o,s,a,i,l;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(o=null===(t=document.getElementById("seeq-url"))||void 0===t?void 0:t.value,s=null===(n=document.getElementById("seeq-access-key"))||void 0===n?void 0:n.value,a=null===(r=document.getElementById("seeq-password"))||void 0===r?void 0:r.value,o&&s&&a){e.n=1;break}return E("Please fill in all required fields","error"),e.a(2);case 1:return E("Authenticating...","loading"),e.p=2,p||(p=new c(o)),e.n=3,p.authenticate(s,a,"Seeq",!1);case 3:(i=e.v).success?(E("Authentication successful","success"),P(o,s,a),O(!0),x("auth",i)):E(i.message,"error"),e.n=5;break;case 4:e.p=4,l=e.v,E("Authentication failed: ".concat(l),"error");case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function _(){return S.apply(this,arguments)}function S(){return(S=h(u().m(function e(){var t,n,r,o,s;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value){e.n=1;break}return E("Please enter sensor names to search for","error"),e.a(2);case 1:if(0!==(r=n.split(",").map(function(e){return e.trim()}).filter(function(e){return e})).length){e.n=2;break}return E("Please enter valid sensor names","error"),e.a(2);case 2:if(E("Searching for sensors...","loading"),e.p=3,p){e.n=4;break}return E("Please test connection first","error"),e.a(2);case 4:return e.n=5,p.searchSensors(r);case 5:(o=e.v).success?(E("Found ".concat(o.sensor_count," sensors"),"success"),x("search",o),R(o.search_results)):E(o.message,"error"),e.n=7;break;case 6:e.p=6,s=e.v,E("Sensor search failed: ".concat(s),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function b(){return T.apply(this,arguments)}function T(){return(T=h(u().m(function e(){var t,n,r,o,s,a,i,c,l,d,h,f;return u().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("start-time"))||void 0===n?void 0:n.value,i=null===(r=document.getElementById("end-time"))||void 0===r?void 0:r.value,c=null===(o=document.getElementById("grid-interval"))||void 0===o?void 0:o.value,s&&a&&i){e.n=1;break}return E("Please fill in all required fields","error"),e.a(2);case 1:if(l=s.split(",").map(function(e){return e.trim()}).filter(function(e){return e}),d=c||"15min",0!==l.length){e.n=2;break}return E("Please enter valid sensor names","error"),e.a(2);case 2:if(E("Pulling sensor data...","loading"),e.p=3,p){e.n=4;break}return E("Please test connection first","error"),e.a(2);case 4:return e.n=5,p.searchAndPullSensors(l,a,i,d);case 5:(h=e.v).success?(E("Retrieved data for ".concat(h.sensor_count," sensors"),"success"),x("data",h),q(h)):E(h.message,"error"),e.n=7;break;case 6:e.p=6,f=e.v,E("Data retrieval failed: ".concat(f),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function k(){localStorage.removeItem("seeq_credentials"),p&&p.logout(),O(!1),E("Logged out successfully","info"),document.getElementById("seeq-url").value="",document.getElementById("seeq-access-key").value="",document.getElementById("seeq-password").value=""}function E(e,t){var n=document.getElementById("auth-status");n&&(n.textContent=e,n.className="auth-status ".concat(t))}function O(e){var t=document.getElementById("authenticate"),n=document.getElementById("logout"),r=document.getElementById("seeq-url"),o=document.getElementById("seeq-access-key"),s=document.getElementById("seeq-password");e?(t.style.display="none",n.style.display="inline-block",r.disabled=!0,o.disabled=!0,s.disabled=!0):(t.style.display="inline-block",n.style.display="none",r.disabled=!1,o.disabled=!1,s.disabled=!1)}function P(e,t,n,r){var o={url:e,accessKey:t,password:n,ignoreSsl:!1,timestamp:(new Date).toISOString()};localStorage.setItem("seeq_credentials",JSON.stringify(o))}function x(e,t){try{var n=JSON.stringify(t),r='=SEEQ_UPDATE_CACHE("'.concat(e,"\", '").concat(n,"')");Excel.run(function(){var e=h(u().m(function e(t){return u().w(function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[[r]],e.n=1,t.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("Could not update Excel cache automatically:",e),console.log("Manual cache update required:",r)})}catch(e){console.error("Failed to update Excel cache:",e)}}function R(e){var t=document.getElementById("search-results");if(t&&e.length>0){var n="\n      <h3>Search Results (".concat(e.length,' sensors)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Original Name</th>\n              <th>Seeq Name</th>\n              <th>ID</th>\n              <th>Type</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n    ');e.forEach(function(e){n+="\n        <tr>\n          <td>".concat(e.Original_Name||e.Name||"N/A","</td>\n          <td>").concat(e.Name||"N/A","</td>\n          <td>").concat(e.ID||"Not Found","</td>\n          <td>").concat(e.Type||"N/A","</td>\n          <td>").concat(e.Status||"Unknown","</td>\n        </tr>\n      ")}),n+="\n          </tbody>\n        </table>\n      </div>\n    ",t.innerHTML=n}}function q(e){var t=document.getElementById("data-results");if(t&&e.data&&e.data.length>0){var n=e.data.slice(0,10),r="\n      <h3>Data Results (".concat(e.data.length,' rows)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Timestamp</th>\n              ').concat(e.data_columns.map(function(e){return"<th>".concat(e,"</th>")}).join(""),"\n            </tr>\n          </thead>\n          <tbody>\n    ");n.forEach(function(t){r+="\n        <tr>\n          <td>".concat(t.Timestamp||t.index||"N/A","</td>\n          ").concat(e.data_columns.map(function(e){return"<td>".concat(void 0!==t[e]?t[e]:"N/A","</td>")}).join(""),"\n        </tr>\n      ")}),r+="\n          </tbody>\n        </table>\n        ".concat(e.data.length>10?"<p><em>Showing first 10 of ".concat(e.data.length," rows</em></p>"):"","\n      </div>\n    "),t.innerHTML=r}}Office.onReady(h(u().m(function e(){var t,n;return u().w(function(e){for(;;)switch(e.n){case 0:return t=document.getElementById("sideload-msg"),n=document.getElementById("app-body"),t&&(t.style.display="none"),n&&(n.style.display="flex"),e.n=1,g();case 1:m();case 2:return e.a(2)}},e)}))),window.clearDiagnostics=function(){p&&p.clearDiagnostics();var e=document.getElementById("diagnostics");e&&(e.innerHTML='<div class="diagnostics-panel"><p>Diagnostics cleared. Run a connection test to generate new diagnostics.</p></div>')},window.exportDiagnostics=function(){if(p){var e=p.getDiagnostics(),t={timestamp:(new Date).toISOString(),diagnostics:e,userAgent:navigator.userAgent,url:window.location.href},n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download="sqexcel-diagnostics-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}}}(),new URL(n(98362),n.b)}();
//# sourceMappingURL=taskpane.js.map