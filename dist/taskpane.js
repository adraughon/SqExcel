/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={98362:function(e,n,t){e.exports=t.p+"assets/logo-filled.png"}},n={};function t(o){var s=n[o];if(void 0!==s)return s.exports;var r=n[o]={exports:{}};return e[o](r,r.exports,t),r.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var o=n.getElementsByTagName("script");if(o.length)for(var s=o.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=o[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b=document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(){var e,o,s="function"==typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",a=s.toStringTag||"@@toStringTag";function i(n,s,r,a){var i=s&&s.prototype instanceof l?s:l,u=Object.create(i.prototype);return t(u,"_invoke",function(n,t,s){var r,a,i,l=0,u=s||[],d=!1,g={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(n,t){return r=n,a=0,i=e,g.n=t,c}};function v(n,t){for(a=n,i=t,o=0;!d&&l&&!s&&o<u.length;o++){var s,r=u[o],v=g.p,h=r[2];n>3?(s=h===t)&&(i=r[(a=r[4])?5:(a=3,3)],r[4]=r[5]=e):r[0]<=v&&((s=n<2&&v<r[1])?(a=0,g.v=t,g.n=r[1]):v<h&&(s=n<3||r[0]>t||t>h)&&(r[4]=n,r[5]=t,g.n=h,a=0))}if(s||n>1)return c;throw d=!0,t}return function(s,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,h),a=u,i=h;(o=a<2?e:i)||!d;){r||(a?a<3?(a>1&&(g.n=-1),v(a,i)):g.n=i:g.v=i);try{if(l=2,r){if(a||(s="next"),o=r[s]){if(!(o=o.call(r,i)))throw TypeError("iterator result is not an object");if(!o.done)return o;i=o.value,a<2&&(a=0)}else 1===a&&(o=r.return)&&o.call(r),a<2&&(i=TypeError("The iterator does not provide a '"+s+"' method"),a=1);r=e}else if((o=(d=g.n<0)?i:n.call(t,g))!==c)break}catch(n){r=e,a=1,i=n}finally{l=1}}return{value:o,done:d}}}(n,r,a),!0),u}var c={};function l(){}function u(){}function d(){}o=Object.getPrototypeOf;var g=[][r]?o(o([][r]())):(t(o={},r,function(){return this}),o),v=d.prototype=l.prototype=Object.create(g);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e}return u.prototype=d,t(v,"constructor",d),t(d,"constructor",u),u.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(v),t(v,a,"Generator"),t(v,r,function(){return this}),t(v,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:h}})()}function t(e,n,o,s){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}t=function(e,n,o,s){function a(n,o){t(e,n,function(e){return this._invoke(n,o,e)})}n?r?r(e,n,{value:o,enumerable:!s,configurable:!s,writable:!s}):e[n]=o:(a("next",0),a("throw",1),a("return",2))},t(e,n,o,s)}function o(e,n,t,o,s,r,a){try{var i=e[r](a),c=i.value}catch(e){return void t(e)}i.done?n(c):Promise.resolve(c).then(o,s)}function s(e){return function(){var n=this,t=arguments;return new Promise(function(s,r){var a=e.apply(n,t);function i(e){o(a,s,r,i,c,"next",e)}function c(e){o(a,s,r,i,c,"throw",e)}i(void 0)})}}function r(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,i(o.key),o)}}function a(e,n,t){return(n=i(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var o=t.call(n,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}var c=function(){return e=function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"authToken",null),a(this,"credentials",null),a(this,"diagnosticLog",[]),this.seeqServerUrl=n.replace(/\/$/,""),this.proxyUrl="https://sq-excel-web.vercel.app",this.logDiagnostic("CLIENT_INIT","SeeqAPIClient initialized with proxy: ".concat(this.proxyUrl,", Seeq server: ").concat(this.seeqServerUrl))},t=[{key:"logDiagnostic",value:function(e,n,t){var o={timestamp:(new Date).toISOString(),category:e,message:n,data:t,userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()};this.diagnosticLog.push(o),console.log("[".concat(e,"] ").concat(n),t||"")}},{key:"detectAppDomain",value:function(){try{return"undefined"!=typeof Office&&Office.context?"Office.js - ".concat(Office.context.host||"Unknown Host"):"https:"===window.location.protocol?"HTTPS Web Context":"http:"===window.location.protocol?"HTTP Web Context":"file:"===window.location.protocol?"File Protocol Context":"Unknown Context - ".concat(window.location.protocol)}catch(e){return"Error detecting context: ".concat(e)}}},{key:"getNetworkInfo",value:function(){try{var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return{online:navigator.onLine,connectionType:(null==e?void 0:e.effectiveType)||"unknown",downlink:(null==e?void 0:e.downlink)||"unknown",rtt:(null==e?void 0:e.rtt)||"unknown"}}catch(e){return{online:navigator.onLine,error:e.toString()}}}},{key:"getDiagnostics",value:function(){return{clientInfo:{proxyUrl:this.proxyUrl,seeqServerUrl:this.seeqServerUrl,isAuthenticated:!!this.authToken,diagnosticLogCount:this.diagnosticLog.length},environment:{userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo(),timestamp:(new Date).toISOString()},recentLogs:this.diagnosticLog.slice(-20)}}},{key:"clearDiagnostics",value:function(){this.diagnosticLog=[],this.logDiagnostic("DIAGNOSTICS_CLEARED","Diagnostic logs cleared")}},{key:"testConnection",value:(l=s(n().m(function e(){var t,o,s,r,a,i,c,l,u,d,g;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=Date.now(),o="".concat(this.proxyUrl,"/api/seeq/test-connection"),this.logDiagnostic("PROXY_CONNECTION_TEST_START","Testing connection to proxy server: ".concat(this.proxyUrl),{url:o,seeqServerUrl:this.seeqServerUrl,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()}),e.p=1,e.n=2,fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl})});case 2:if(s=e.v,r=Date.now()-t,a={},s.headers.forEach(function(e,n){a[n]=e}),this.logDiagnostic("PROXY_CONNECTION_RESPONSE","Proxy connection test response received",{status:s.status,statusText:s.statusText,requestTime:r,allHeaders:a,url:s.url}),!s.ok){e.n=4;break}return e.n=3,s.json();case 3:return i=e.v,this.logDiagnostic("PROXY_CONNECTION_SUCCESS","Proxy connection test successful",i),e.a(2,{success:!0,message:i.message||"Proxy server is reachable and can connect to Seeq",status_code:s.status,diagnostics:{response_headers:a,request_timing:r,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 4:return e.n=5,s.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_CONNECTION_FAILED","Proxy connection test failed with status: ".concat(s.status),{status:s.status,statusText:s.statusText,headers:a,errorData:c}),e.a(2,{success:!1,message:c.message||"Proxy server responded with status code: ".concat(s.status),status_code:s.status,error:c.error||"HTTP ".concat(s.status),diagnostics:{response_headers:a,request_timing:r,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 6:e.n=8;break;case 7:return e.p=7,g=e.v,l=Date.now()-t,this.logDiagnostic("PROXY_CONNECTION_ERROR","Proxy connection test error",{error:g.message,errorName:g.name,errorStack:g.stack,requestTime:l,url:o}),u="Proxy connection test failed",d="Unknown","TypeError"===g.name&&g.message.includes("fetch")?(u="Cannot connect to proxy server - connection refused. This may be due to network issues.",d="ConnectionError"):"AbortError"===g.name?(u="Connection timeout - the proxy server took too long to respond.",d="Timeout"):g.message.includes("Failed to fetch")?(u="Connection failed - unable to reach the proxy server. This may be due to network problems.",d="FetchError"):(u="Proxy connection test failed: ".concat(g.message),d=g.message),e.a(2,{success:!1,message:u,error:d,diagnostics:{request_timing:l,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(){return l.apply(this,arguments)})},{key:"authenticate",value:(c=s(n().m(function e(t,o){var s,r,a,i,c,l,u,d,g=arguments;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=g.length>2&&void 0!==g[2]?g[2]:"Seeq",r=g.length>3&&void 0!==g[3]&&g[3],e.p=1,this.credentials={accessKey:t,password:o,authProvider:s,ignoreSslErrors:r,seeq_url:this.seeqServerUrl},this.logDiagnostic("PROXY_AUTH_START","Attempting to authenticate through proxy: ".concat(this.proxyUrl),{seeqServerUrl:this.seeqServerUrl,accessKey:t,authProvider:s}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:t,password:o,auth_provider:s,ignore_ssl_errors:r})});case 2:if(a=e.v,this.logDiagnostic("PROXY_AUTH_RESPONSE","Proxy authentication response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=4;break}return e.n=3,a.json();case 3:return i=e.v,this.authToken=i.token||"authenticated",this.logDiagnostic("PROXY_AUTH_SUCCESS","Proxy authentication successful",{user:i.user,server_url:i.server_url}),e.a(2,{success:!0,message:i.message||"Successfully authenticated as ".concat(t),user:i.user||t,server_url:i.server_url||this.seeqServerUrl,token:this.authToken});case 4:return e.n=5,a.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_AUTH_FAILED","Proxy authentication failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Authentication failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status)});case 6:e.n=8;break;case 7:return e.p=7,d=e.v,this.logDiagnostic("PROXY_AUTH_ERROR","Proxy authentication error",{error:d.message,errorName:d.name}),l="Authentication failed",u="Unknown","TypeError"===d.name&&d.message.includes("fetch")?(l="Network error: Cannot connect to proxy server. Please check your internet connection.",u="NetworkError"):"AbortError"===d.name?(l="Request timeout: The authentication request took too long. Please try again.",u="TimeoutError"):d.message.includes("Failed to fetch")?(l="Connection failed: Unable to reach the proxy server. This may be due to network issues.",u="ConnectionError"):(l="Authentication failed: ".concat(d.message),u=d.name||"UnknownError"),e.a(2,{success:!1,message:l,error:u});case 8:return e.a(2)}},e,this,[[1,7]])})),function(e,n){return c.apply(this,arguments)})},{key:"searchSensors",value:function(){var e=s(n().m(function e(t){var o,s,r,a,i,c,l;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.authToken||this.credentials){e.n=1;break}return e.a(2,{success:!1,message:"Not authenticated. Please authenticate first.",error:"Authentication required",search_results:[],sensor_count:0});case 1:return e.p=1,this.logDiagnostic("PROXY_SEARCH_START","Searching for sensors through proxy",{sensorNames:t,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/search"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:t,username:null===(o=this.credentials)||void 0===o?void 0:o.accessKey,password:null===(s=this.credentials)||void 0===s?void 0:s.password,auth_provider:(null===(r=this.credentials)||void 0===r?void 0:r.authProvider)||"Seeq"})});case 2:if(a=e.v,this.logDiagnostic("PROXY_SEARCH_RESPONSE","Proxy search response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=4;break}return e.n=3,a.json();case 3:return i=e.v,this.logDiagnostic("PROXY_SEARCH_SUCCESS","Proxy search successful",{sensorCount:i.sensor_count,searchResults:i.search_results}),e.a(2,{success:!0,message:i.message||"Found ".concat(i.sensor_count," sensors"),search_results:i.search_results||[],sensor_count:i.sensor_count||0});case 4:return e.n=5,a.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_SEARCH_FAILED","Proxy search failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Search failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status),search_results:[],sensor_count:0});case 6:e.n=8;break;case 7:return e.p=7,l=e.v,this.logDiagnostic("PROXY_SEARCH_ERROR","Proxy search error",{error:l.message,errorName:l.name}),e.a(2,{success:!1,message:"Sensor search failed: ".concat(l.message),error:l.message,search_results:[],sensor_count:0});case 8:return e.a(2)}},e,this,[[1,7]])}));return function(n){return e.apply(this,arguments)}}()},{key:"searchAndPullSensors",value:(i=s(n().m(function e(t,o,s){var r,a,i,c,l,u,d,g,v,h=arguments;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=h.length>3&&void 0!==h[3]?h[3]:"15min",e.p=1,this.logDiagnostic("PROXY_SEARCH_PULL_START","Searching and pulling sensor data through proxy",{sensorNames:t,startTime:o,endTime:s,grid:r,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/data"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:t,start_time:o,end_time:s,grid:r,username:null===(a=this.credentials)||void 0===a?void 0:a.accessKey,password:null===(i=this.credentials)||void 0===i?void 0:i.password,auth_provider:(null===(c=this.credentials)||void 0===c?void 0:c.authProvider)||"Seeq"})});case 2:if(l=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_RESPONSE","Proxy search and pull response received",{status:l.status,statusText:l.statusText}),!l.ok){e.n=4;break}return e.n=3,l.json();case 3:return d=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_SUCCESS","Proxy search and pull successful",{sensorCount:d.sensor_count,dataLength:(null===(u=d.data)||void 0===u?void 0:u.length)||0,dataColumns:d.data_columns}),e.a(2,{success:!0,message:d.message||"Successfully retrieved data for ".concat(d.sensor_count," sensors"),search_results:d.search_results||[],data:d.data||[],data_columns:d.data_columns||[],data_index:d.data_index||[],sensor_count:d.sensor_count||0,time_range:{start:o,end:s,grid:r}});case 4:return e.n=5,l.json().catch(function(){return{}});case 5:return g=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_FAILED","Proxy search and pull failed",{status:l.status,errorData:g}),e.a(2,{success:!1,message:g.message||"Search and pull failed with status ".concat(l.status),error:g.error||"HTTP ".concat(l.status),search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:o,end:s,grid:r}});case 6:e.n=8;break;case 7:return e.p=7,v=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_ERROR","Proxy search and pull error",{error:v.message,errorName:v.name}),e.a(2,{success:!1,message:"Search and pull operation failed: ".concat(v.message),error:v.message,search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:o,end:s,grid:r}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(e,n,t){return i.apply(this,arguments)})},{key:"getAuthStatus",value:function(){var e;return{isAuthenticated:!!this.authToken,user:null===(e=this.credentials)||void 0===e?void 0:e.accessKey}}},{key:"logout",value:(o=s(n().m(function e(){var t,o,s;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!this.authToken){e.n=2;break}return this.logDiagnostic("PROXY_LOGOUT_START","Logging out through proxy"),e.n=1,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:null===(t=this.credentials)||void 0===t?void 0:t.accessKey})});case 1:o=e.v,this.logDiagnostic("PROXY_LOGOUT_RESPONSE","Proxy logout response received",{status:o.status,statusText:o.statusText});case 2:e.n=4;break;case 3:e.p=3,s=e.v,this.logDiagnostic("PROXY_LOGOUT_ERROR","Proxy logout error",{error:s.message});case 4:return e.p=4,this.authToken=null,this.credentials=null,e.f(4);case 5:return e.a(2)}},e,this,[[0,3,4,5]])})),function(){return o.apply(this,arguments)})},{key:"getCredentials",value:function(){return this.credentials}},{key:"setCredentials",value:function(e){this.credentials=e}}],t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o,i,c,l}();function l(){var e,n,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",s=t.toStringTag||"@@toStringTag";function r(t,o,s,r){var c=o&&o.prototype instanceof i?o:i,l=Object.create(c.prototype);return u(l,"_invoke",function(t,o,s){var r,i,c,l=0,u=s||[],d=!1,g={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(n,t){return r=n,i=0,c=e,g.n=t,a}};function v(t,o){for(i=t,c=o,n=0;!d&&l&&!s&&n<u.length;n++){var s,r=u[n],v=g.p,h=r[2];t>3?(s=h===o)&&(c=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=e):r[0]<=v&&((s=t<2&&v<r[1])?(i=0,g.v=o,g.n=r[1]):v<h&&(s=t<3||r[0]>o||o>h)&&(r[4]=t,r[5]=o,g.n=h,i=0))}if(s||t>1)return a;throw d=!0,o}return function(s,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,h),i=u,c=h;(n=i<2?e:c)||!d;){r||(i?i<3?(i>1&&(g.n=-1),v(i,c)):g.n=c:g.v=c);try{if(l=2,r){if(i||(s="next"),n=r[s]){if(!(n=n.call(r,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=r.return)&&n.call(r),i<2&&(c=TypeError("The iterator does not provide a '"+s+"' method"),i=1);r=e}else if((n=(d=g.n<0)?c:t.call(o,g))!==a)break}catch(n){r=e,i=1,c=n}finally{l=1}}return{value:n,done:d}}}(t,s,r),!0),l}var a={};function i(){}function c(){}function d(){}n=Object.getPrototypeOf;var g=[][o]?n(n([][o]())):(u(n={},o,function(){return this}),n),v=d.prototype=i.prototype=Object.create(g);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e}return c.prototype=d,u(v,"constructor",d),u(d,"constructor",c),c.displayName="GeneratorFunction",u(d,s,"GeneratorFunction"),u(v),u(v,s,"Generator"),u(v,o,function(){return this}),u(v,"toString",function(){return"[object Generator]"}),(l=function(){return{w:r,m:h}})()}function u(e,n,t,o){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}u=function(e,n,t,o){function r(n,t){u(e,n,function(e){return this._invoke(n,t,e)})}n?s?s(e,n,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[n]=t:(r("next",0),r("throw",1),r("return",2))},u(e,n,t,o)}function d(e,n,t,o,s,r,a){try{var i=e[r](a),c=i.value}catch(e){return void t(e)}i.done?n(c):Promise.resolve(c).then(o,s)}function g(e){return function(){var n=this,t=arguments;return new Promise(function(o,s){var r=e.apply(n,t);function a(e){d(r,o,s,a,i,"next",e)}function i(e){d(r,o,s,a,i,"throw",e)}a(void 0)})}}var v="Loading...",h=null;function f(){return p.apply(this,arguments)}function p(){return(p=g(l().m(function e(){var n,t,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Attempting to load version info..."),e.n=1,fetch("./version.json");case 1:if(n=e.v,console.log("Relative path response status:",n.status),n.ok){e.n=3;break}return console.log("Relative path failed, trying full URL..."),e.n=2,fetch("https://adraughon.github.io/SqExcel/version.json");case 2:n=e.v,console.log("Full URL response status:",n.status);case 3:if(!n.ok){e.n=5;break}return e.n=4,n.json();case 4:t=e.v,console.log("Version data loaded:",t),v="".concat(t.version," - ").concat(t.description),e.n=6;break;case 5:console.error("Failed to load version.json, status:",n.status),v="Version info unavailable";case 6:e.n=8;break;case 7:e.p=7,o=e.v,console.error("Failed to load version info:",o),v="Version info unavailable";case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function m(){var e=document.getElementById("test-connection"),n=document.getElementById("authenticate"),t=document.getElementById("logout"),o=document.getElementById("search-sensors"),s=document.getElementById("pull-data");e&&(e.onclick=y),n&&(n.onclick=_),t&&(t.onclick=O),o&&(o.onclick=b),s&&(s.onclick=T),function(){var e=localStorage.getItem("seeq_credentials");if(e)try{var n=JSON.parse(e);document.getElementById("seeq-url").value=n.url||"",document.getElementById("seeq-access-key").value=n.accessKey||"",document.getElementById("seeq-password").value=n.password||"",document.getElementById("ignore-ssl").checked=n.ignoreSsl||!1;var t=new Date(n.timestamp);((new Date).getTime()-t.getTime())/36e5<24?(R(!0),P("Using saved credentials","info"),n.url&&(h=new c(n.url))):localStorage.removeItem("seeq_credentials")}catch(e){console.error("Failed to load saved credentials:",e),localStorage.removeItem("seeq_credentials")}}(),console.log("SqExcel Add-in Version: ".concat(v)),P("Add-in Version: ".concat(v),"info")}function y(){return w.apply(this,arguments)}function w(){return(w=g(l().m(function e(){var n,t,o,s,r;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=null===(n=document.getElementById("seeq-url"))||void 0===n?void 0:n.value){e.n=1;break}return P("Please enter a Seeq server URL","error"),e.a(2);case 1:return P("Testing connection...","loading"),e.p=2,h=new c(t),e.n=3,h.testConnection();case 3:if(!(o=e.v).success){e.n=5;break}return P(o.message,"success"),P("Testing authentication endpoint...","loading"),e.n=4,h.testAuthEndpoint();case 4:(s=e.v).success?P("".concat(o.message," - ").concat(s.message),"success"):P("".concat(o.message," - Warning: ").concat(s.message),"warning"),C(o,s),D("auth",o),e.n=6;break;case 5:P(o.message,"error"),q(o);case 6:e.n=8;break;case 7:e.p=7,r=e.v,P("Connection test failed: ".concat(r),"error"),q({success:!1,message:r.toString(),error:r.toString()});case 8:return e.a(2)}},e,null,[[2,7]])}))).apply(this,arguments)}function _(){return S.apply(this,arguments)}function S(){return(S=g(l().m(function e(){var n,t,o,s,r,a,i,u,d,g;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=null===(n=document.getElementById("seeq-url"))||void 0===n?void 0:n.value,a=null===(t=document.getElementById("seeq-access-key"))||void 0===t?void 0:t.value,i=null===(o=document.getElementById("seeq-password"))||void 0===o?void 0:o.value,u=null===(s=document.getElementById("ignore-ssl"))||void 0===s?void 0:s.checked,r&&a&&i){e.n=1;break}return P("Please fill in all required fields","error"),e.a(2);case 1:return P("Authenticating...","loading"),e.p=2,h||(h=new c(r)),e.n=3,h.authenticate(a,i,"Seeq",u);case 3:(d=e.v).success?(P("Authentication successful","success"),x(r,a,i,u),R(!0),D("auth",d)):P(d.message,"error"),e.n=5;break;case 4:e.p=4,g=e.v,P("Authentication failed: ".concat(g),"error");case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function b(){return k.apply(this,arguments)}function k(){return(k=g(l().m(function e(){var n,t,o,s,r;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(t=null===(n=document.getElementById("sensor-names"))||void 0===n?void 0:n.value){e.n=1;break}return P("Please enter sensor names to search for","error"),e.a(2);case 1:if(0!==(o=t.split(",").map(function(e){return e.trim()}).filter(function(e){return e})).length){e.n=2;break}return P("Please enter valid sensor names","error"),e.a(2);case 2:if(P("Searching for sensors...","loading"),e.p=3,h){e.n=4;break}return P("Please test connection first","error"),e.a(2);case 4:return e.n=5,h.searchSensors(o);case 5:(s=e.v).success?(P("Found ".concat(s.sensor_count," sensors"),"success"),D("search",s),I(s.search_results)):P(s.message,"error"),e.n=7;break;case 6:e.p=6,r=e.v,P("Sensor search failed: ".concat(r),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function T(){return E.apply(this,arguments)}function E(){return(E=g(l().m(function e(){var n,t,o,s,r,a,i,c,u,d,g,v;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(r=null===(n=document.getElementById("sensor-names"))||void 0===n?void 0:n.value,a=null===(t=document.getElementById("start-time"))||void 0===t?void 0:t.value,i=null===(o=document.getElementById("end-time"))||void 0===o?void 0:o.value,c=null===(s=document.getElementById("grid-interval"))||void 0===s?void 0:s.value,r&&a&&i){e.n=1;break}return P("Please fill in all required fields","error"),e.a(2);case 1:if(u=r.split(",").map(function(e){return e.trim()}).filter(function(e){return e}),d=c||"15min",0!==u.length){e.n=2;break}return P("Please enter valid sensor names","error"),e.a(2);case 2:if(P("Pulling sensor data...","loading"),e.p=3,h){e.n=4;break}return P("Please test connection first","error"),e.a(2);case 4:return e.n=5,h.searchAndPullSensors(u,a,i,d);case 5:(g=e.v).success?(P("Retrieved data for ".concat(g.sensor_count," sensors"),"success"),D("data",g),A(g)):P(g.message,"error"),e.n=7;break;case 6:e.p=6,v=e.v,P("Data retrieval failed: ".concat(v),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function O(){localStorage.removeItem("seeq_credentials"),h&&h.logout(),R(!1),P("Logged out successfully","info"),document.getElementById("seeq-url").value="",document.getElementById("seeq-access-key").value="",document.getElementById("seeq-password").value="",document.getElementById("ignore-ssl").checked=!1}function P(e,n){var t=document.getElementById("auth-status");t&&(t.textContent=e,t.className="auth-status ".concat(n))}function R(e){var n=document.getElementById("test-connection"),t=document.getElementById("authenticate"),o=document.getElementById("logout"),s=document.getElementById("seeq-url"),r=document.getElementById("seeq-access-key"),a=document.getElementById("seeq-password"),i=document.getElementById("ignore-ssl");e?(n.style.display="none",t.style.display="none",o.style.display="inline-block",s.disabled=!0,r.disabled=!0,a.disabled=!0,i.disabled=!0):(n.style.display="inline-block",t.style.display="inline-block",o.style.display="none",s.disabled=!1,r.disabled=!1,a.disabled=!1,i.disabled=!1)}function x(e,n,t,o){var s={url:e,accessKey:n,password:t,ignoreSsl:o,timestamp:(new Date).toISOString()};localStorage.setItem("seeq_credentials",JSON.stringify(s))}function D(e,n){try{var t=JSON.stringify(n),o='=SEEQ_UPDATE_CACHE("'.concat(e,"\", '").concat(t,"')");Excel.run(function(){var e=g(l().m(function e(n){return l().w(function(e){for(;;)switch(e.n){case 0:return n.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[[o]],e.n=1,n.sync();case 1:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}()).catch(function(e){console.log("Could not update Excel cache automatically:",e),console.log("Manual cache update required:",o)})}catch(e){console.error("Failed to update Excel cache:",e)}}function I(e){var n=document.getElementById("search-results");if(n&&e.length>0){var t="\n      <h3>Search Results (".concat(e.length,' sensors)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Original Name</th>\n              <th>Seeq Name</th>\n              <th>ID</th>\n              <th>Type</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n    ');e.forEach(function(e){t+="\n        <tr>\n          <td>".concat(e.Original_Name||e.Name||"N/A","</td>\n          <td>").concat(e.Name||"N/A","</td>\n          <td>").concat(e.ID||"Not Found","</td>\n          <td>").concat(e.Type||"N/A","</td>\n          <td>").concat(e.Status||"Unknown","</td>\n        </tr>\n      ")}),t+="\n          </tbody>\n        </table>\n      </div>\n    ",n.innerHTML=t}}function A(e){var n=document.getElementById("data-results");if(n&&e.data&&e.data.length>0){var t=e.data.slice(0,10),o="\n      <h3>Data Results (".concat(e.data.length,' rows)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Timestamp</th>\n              ').concat(e.data_columns.map(function(e){return"<th>".concat(e,"</th>")}).join(""),"\n            </tr>\n          </thead>\n          <tbody>\n    ");t.forEach(function(n){o+="\n        <tr>\n          <td>".concat(n.Timestamp||n.index||"N/A","</td>\n          ").concat(e.data_columns.map(function(e){return"<td>".concat(void 0!==n[e]?n[e]:"N/A","</td>")}).join(""),"\n        </tr>\n      ")}),o+="\n          </tbody>\n        </table>\n        ".concat(e.data.length>10?"<p><em>Showing first 10 of ".concat(e.data.length," rows</em></p>"):"","\n      </div>\n    "),n.innerHTML=o}}function C(e,n){var t,o=document.getElementById("diagnostics");if(o){var s=null===(t=h)||void 0===t?void 0:t.getDiagnostics();if(s){var r='\n    <div class="diagnostics-panel">\n      <h3>üîç Connection Diagnostics</h3>\n      <div class="diagnostic-section">\n        <h4>Environment Information</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>App Domain:</strong> '.concat(s.environment.appDomain,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Origin:</strong> ').concat(s.environment.origin,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Network Type:</strong> ').concat(s.environment.networkInfo.connectionType,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Online Status:</strong> ').concat(s.environment.networkInfo.online?"‚úÖ Online":"‚ùå Offline","\n          </div>\n        </div>\n      </div>\n  ");if(e.diagnostics&&(r+='\n      <div class="diagnostic-section">\n        <h4>Connection Test Results</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>Response Time:</strong> '.concat(e.diagnostics.request_timing,'ms\n          </div>\n          <div class="diagnostic-item">\n            <strong>Status Code:</strong> ').concat(e.status_code,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>CORS Status:</strong> ').concat(e.diagnostics.cors_status,"\n          </div>\n        </div>\n    "),e.diagnostics.response_headers&&(r+='\n        <div class="cors-headers">\n          <h5>CORS Headers:</h5>\n          <ul>\n      ',["access-control-allow-origin","access-control-allow-methods","access-control-allow-headers","access-control-allow-credentials"].forEach(function(n){var t=e.diagnostics.response_headers[n];r+="<li><strong>".concat(n,":</strong> ").concat(t||"Not set","</li>")}),r+="</ul></div>"),r+="</div>"),n.diagnostics){if(r+='\n      <div class="diagnostic-section">\n        <h4>Authentication Endpoint Test</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>Response Time:</strong> '.concat(n.diagnostics.request_timing,'ms\n          </div>\n          <div class="diagnostic-item">\n            <strong>Status Code:</strong> ').concat(n.status_code,"\n          </div>\n        </div>\n    "),n.diagnostics.cors_analysis){var a=n.diagnostics.cors_analysis;r+='\n        <div class="cors-analysis">\n          <h5>CORS Configuration Analysis:</h5>\n          <div class="cors-status">\n            <div class="cors-item '.concat(a.allowsOrigin?"success":"error",'">\n              <strong>Origin Allowed:</strong> ').concat(a.allowsOrigin?"‚úÖ Yes":"‚ùå No",'\n            </div>\n            <div class="cors-item ').concat(a.allowsMethods?"success":"error",'">\n              <strong>Methods Allowed:</strong> ').concat(a.allowsMethods?"‚úÖ Yes":"‚ùå No",'\n            </div>\n            <div class="cors-item ').concat(a.allowsHeaders?"success":"error",'">\n              <strong>Headers Allowed:</strong> ').concat(a.allowsHeaders?"‚úÖ Yes":"‚ùå No","\n            </div>\n          </div>\n      "),a.issues.length>0&&(r+='\n          <div class="cors-issues">\n            <h6>Issues Found:</h6>\n            <ul>\n              '.concat(a.issues.map(function(e){return"<li>‚ùå ".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        ")),a.recommendations.length>0&&(r+='\n          <div class="cors-recommendations">\n            <h6>Recommendations:</h6>\n            <ul>\n              '.concat(a.recommendations.map(function(e){return"<li>üí° ".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        ")),r+="</div>"}r+="</div>"}s.recentLogs&&s.recentLogs.length>0&&(r+='\n      <div class="diagnostic-section">\n        <h4>Recent Diagnostic Logs</h4>\n        <div class="log-entries">\n    ',s.recentLogs.slice(-10).forEach(function(e){var n=new Date(e.timestamp).toLocaleTimeString();r+='\n        <div class="log-entry">\n          <span class="log-time">'.concat(n,'</span>\n          <span class="log-category">[').concat(e.category,']</span>\n          <span class="log-message">').concat(e.message,"</span>\n        </div>\n      ")}),r+="</div></div>"),r+='\n      <div class="diagnostic-actions">\n        <button onclick="clearDiagnostics()" class="btn-secondary">Clear Logs</button>\n        <button onclick="exportDiagnostics()" class="btn-secondary">Export Diagnostics</button>\n      </div>\n    </div>\n  ',o.innerHTML=r}}}function q(e){var n,t=document.getElementById("diagnostics");if(t){var o=null===(n=h)||void 0===n?void 0:n.getDiagnostics();if(o){var s='\n    <div class="diagnostics-panel error">\n      <h3>‚ùå Error Diagnostics</h3>\n      <div class="error-summary">\n        <h4>Error Summary</h4>\n        <div class="error-details">\n          <div class="error-item">\n            <strong>Error Message:</strong> '.concat(e.message,'\n          </div>\n          <div class="error-item">\n            <strong>Error Type:</strong> ').concat(e.error||"Unknown","\n          </div>\n        </div>\n      </div>\n  ");if(e.diagnostics&&e.diagnostics.error_analysis){var r=e.diagnostics.error_analysis;s+='\n      <div class="diagnostic-section">\n        <h4>Error Analysis</h4>\n        <div class="error-analysis">\n          <div class="analysis-item">\n            <strong>Error Type:</strong> '.concat(r.errorType,'\n          </div>\n          <div class="analysis-item">\n            <strong>Likely Cause:</strong> ').concat(r.likelyCause,'\n          </div>\n          <div class="analysis-flags">\n            <div class="flag ').concat(r.isCorsRelated?"active":"",'">CORS Related</div>\n            <div class="flag ').concat(r.isNetworkRelated?"active":"",'">Network Related</div>\n            <div class="flag ').concat(r.isSslRelated?"active":"",'">SSL Related</div>\n            <div class="flag ').concat(r.isAppDomainRelated?"active":"",'">AppDomain Related</div>\n          </div>\n        </div>\n    '),r.recommendations.length>0&&(s+='\n        <div class="recommendations">\n          <h5>Recommendations:</h5>\n          <ul>\n            '.concat(r.recommendations.map(function(e){return"<li>üí° ".concat(e,"</li>")}).join(""),"\n          </ul>\n        </div>\n      ")),s+="</div>"}s+='\n    <div class="diagnostic-section">\n      <h4>Environment Information</h4>\n      <div class="diagnostic-grid">\n        <div class="diagnostic-item">\n          <strong>App Domain:</strong> '.concat(o.environment.appDomain,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Origin:</strong> ').concat(o.environment.origin,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Network Type:</strong> ').concat(o.environment.networkInfo.connectionType,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Online Status:</strong> ').concat(o.environment.networkInfo.online?"‚úÖ Online":"‚ùå Offline","\n        </div>\n      </div>\n    </div>\n  "),s+='\n    <div class="diagnostic-actions">\n      <button onclick="clearDiagnostics()" class="btn-secondary">Clear Logs</button>\n      <button onclick="exportDiagnostics()" class="btn-secondary">Export Diagnostics</button>\n    </div>\n  </div>\n  ',t.innerHTML=s}}}Office.onReady(g(l().m(function e(){var n,t;return l().w(function(e){for(;;)switch(e.n){case 0:return n=document.getElementById("sideload-msg"),t=document.getElementById("app-body"),n&&(n.style.display="none"),t&&(t.style.display="flex"),e.n=1,f();case 1:m();case 2:return e.a(2)}},e)}))),window.clearDiagnostics=function(){h&&h.clearDiagnostics();var e=document.getElementById("diagnostics");e&&(e.innerHTML='<div class="diagnostics-panel"><p>Diagnostics cleared. Run a connection test to generate new diagnostics.</p></div>')},window.exportDiagnostics=function(){if(h){var e=h.getDiagnostics(),n={timestamp:(new Date).toISOString(),diagnostics:e,userAgent:navigator.userAgent,url:window.location.href},t=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),o=URL.createObjectURL(t),s=document.createElement("a");s.href=o,s.download="sqexcel-diagnostics-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)}}}(),new URL(t(98362),t.b)}();
//# sourceMappingURL=taskpane.js.map