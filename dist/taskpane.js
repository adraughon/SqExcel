/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=o[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,o,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function i(t,r,s,a){var i=r&&r.prototype instanceof l?r:l,u=Object.create(i.prototype);return n(u,"_invoke",function(t,n,r){var s,a,i,l=0,u=r||[],d=!1,g={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return s=t,a=0,i=e,g.n=n,c}};function v(t,n){for(a=t,i=n,o=0;!d&&l&&!r&&o<u.length;o++){var r,s=u[o],v=g.p,h=s[2];t>3?(r=h===n)&&(i=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=v&&((r=t<2&&v<s[1])?(a=0,g.v=n,g.n=s[1]):v<h&&(r=t<3||s[0]>n||n>h)&&(s[4]=t,s[5]=n,g.n=h,a=0))}if(r||t>1)return c;throw d=!0,n}return function(r,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,h),a=u,i=h;(o=a<2?e:i)||!d;){s||(a?a<3?(a>1&&(g.n=-1),v(a,i)):g.n=i:g.v=i);try{if(l=2,s){if(a||(r="next"),o=s[r]){if(!(o=o.call(s,i)))throw TypeError("iterator result is not an object");if(!o.done)return o;i=o.value,a<2&&(a=0)}else 1===a&&(o=s.return)&&o.call(s),a<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),a=1);s=e}else if((o=(d=g.n<0)?i:t.call(n,g))!==c)break}catch(t){s=e,a=1,i=t}finally{l=1}}return{value:o,done:d}}}(t,s,a),!0),u}var c={};function l(){}function u(){}function d(){}o=Object.getPrototypeOf;var g=[][s]?o(o([][s]())):(n(o={},s,function(){return this}),o),v=d.prototype=l.prototype=Object.create(g);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,n(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e}return u.prototype=d,n(v,"constructor",d),n(d,"constructor",u),u.displayName="GeneratorFunction",n(d,a,"GeneratorFunction"),n(v),n(v,a,"Generator"),n(v,s,function(){return this}),n(v,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:h}})()}function n(e,t,o,r){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}n=function(e,t,o,r){function a(t,o){n(e,t,function(e){return this._invoke(t,o,e)})}t?s?s(e,t,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[t]=o:(a("next",0),a("throw",1),a("return",2))},n(e,t,o,r)}function o(e,t,n,o,r,s,a){try{var i=e[s](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(o,r)}function r(e){return function(){var t=this,n=arguments;return new Promise(function(r,s){var a=e.apply(t,n);function i(e){o(a,r,s,i,c,"next",e)}function c(e){o(a,r,s,i,c,"throw",e)}i(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,i(o.key),o)}}function a(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var c=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"authToken",null),a(this,"credentials",null),a(this,"diagnosticLog",[]),this.seeqServerUrl=t.replace(/\/$/,""),this.proxyUrl="https://sqexcel.up.railway.app",this.logDiagnostic("CLIENT_INIT","SeeqAPIClient initialized with proxy: ".concat(this.proxyUrl,", Seeq server: ").concat(this.seeqServerUrl))},n=[{key:"logDiagnostic",value:function(e,t,n){var o={timestamp:(new Date).toISOString(),category:e,message:t,data:n,userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()};this.diagnosticLog.push(o),console.log("[".concat(e,"] ").concat(t),n||"")}},{key:"detectAppDomain",value:function(){try{return"undefined"!=typeof Office&&Office.context?"Office.js - ".concat(Office.context.host||"Unknown Host"):"https:"===window.location.protocol?"HTTPS Web Context":"http:"===window.location.protocol?"HTTP Web Context":"file:"===window.location.protocol?"File Protocol Context":"Unknown Context - ".concat(window.location.protocol)}catch(e){return"Error detecting context: ".concat(e)}}},{key:"getNetworkInfo",value:function(){try{var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return{online:navigator.onLine,connectionType:(null==e?void 0:e.effectiveType)||"unknown",downlink:(null==e?void 0:e.downlink)||"unknown",rtt:(null==e?void 0:e.rtt)||"unknown"}}catch(e){return{online:navigator.onLine,error:e.toString()}}}},{key:"getDiagnostics",value:function(){return{clientInfo:{proxyUrl:this.proxyUrl,seeqServerUrl:this.seeqServerUrl,isAuthenticated:!!this.authToken,diagnosticLogCount:this.diagnosticLog.length},environment:{userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo(),timestamp:(new Date).toISOString()},recentLogs:this.diagnosticLog.slice(-20)}}},{key:"clearDiagnostics",value:function(){this.diagnosticLog=[],this.logDiagnostic("DIAGNOSTICS_CLEARED","Diagnostic logs cleared")}},{key:"testConnection",value:(l=r(t().m(function e(){var n,o,r,s,a,i,c,l,u,d,g;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=Date.now(),o="".concat(this.proxyUrl,"/api/seeq/test-connection"),this.logDiagnostic("PROXY_CONNECTION_TEST_START","Testing connection to proxy server: ".concat(this.proxyUrl),{url:o,seeqServerUrl:this.seeqServerUrl,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()}),e.p=1,e.n=2,fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl})});case 2:if(r=e.v,s=Date.now()-n,a={},r.headers.forEach(function(e,t){a[t]=e}),this.logDiagnostic("PROXY_CONNECTION_RESPONSE","Proxy connection test response received",{status:r.status,statusText:r.statusText,requestTime:s,allHeaders:a,url:r.url}),!r.ok){e.n=4;break}return e.n=3,r.json();case 3:return i=e.v,this.logDiagnostic("PROXY_CONNECTION_SUCCESS","Proxy connection test successful",i),e.a(2,{success:!0,message:i.message||"Proxy server is reachable and can connect to Seeq",status_code:r.status,diagnostics:{response_headers:a,request_timing:s,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 4:return e.n=5,r.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_CONNECTION_FAILED","Proxy connection test failed with status: ".concat(r.status),{status:r.status,statusText:r.statusText,headers:a,errorData:c}),e.a(2,{success:!1,message:c.message||"Proxy server responded with status code: ".concat(r.status),status_code:r.status,error:c.error||"HTTP ".concat(r.status),diagnostics:{response_headers:a,request_timing:s,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 6:e.n=8;break;case 7:return e.p=7,g=e.v,l=Date.now()-n,this.logDiagnostic("PROXY_CONNECTION_ERROR","Proxy connection test error",{error:g.message,errorName:g.name,errorStack:g.stack,requestTime:l,url:o}),u="Proxy connection test failed",d="Unknown","TypeError"===g.name&&g.message.includes("fetch")?(u="Cannot connect to proxy server - connection refused. This may be due to network issues.",d="ConnectionError"):"AbortError"===g.name?(u="Connection timeout - the proxy server took too long to respond.",d="Timeout"):g.message.includes("Failed to fetch")?(u="Connection failed - unable to reach the proxy server. This may be due to network problems.",d="FetchError"):(u="Proxy connection test failed: ".concat(g.message),d=g.message),e.a(2,{success:!1,message:u,error:d,diagnostics:{request_timing:l,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(){return l.apply(this,arguments)})},{key:"authenticate",value:(c=r(t().m(function e(n,o){var r,s,a,i,c,l,u,d,g=arguments;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=g.length>2&&void 0!==g[2]?g[2]:"Seeq",s=g.length>3&&void 0!==g[3]&&g[3],e.p=1,this.credentials={accessKey:n,password:o,authProvider:r,ignoreSslErrors:s,seeq_url:this.seeqServerUrl},this.logDiagnostic("PROXY_AUTH_START","Attempting to authenticate through proxy: ".concat(this.proxyUrl),{seeqServerUrl:this.seeqServerUrl,accessKey:n,authProvider:r}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:n,password:o,auth_provider:r,ignore_ssl_errors:s})});case 2:if(a=e.v,this.logDiagnostic("PROXY_AUTH_RESPONSE","Proxy authentication response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=4;break}return e.n=3,a.json();case 3:return i=e.v,this.authToken=i.token||"authenticated",this.logDiagnostic("PROXY_AUTH_SUCCESS","Proxy authentication successful",{user:i.user,server_url:i.server_url}),e.a(2,{success:!0,message:i.message||"Successfully authenticated as ".concat(n),user:i.user||n,server_url:i.server_url||this.seeqServerUrl,token:this.authToken});case 4:return e.n=5,a.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_AUTH_FAILED","Proxy authentication failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Authentication failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status)});case 6:e.n=8;break;case 7:return e.p=7,d=e.v,this.logDiagnostic("PROXY_AUTH_ERROR","Proxy authentication error",{error:d.message,errorName:d.name}),l="Authentication failed",u="Unknown","TypeError"===d.name&&d.message.includes("fetch")?(l="Network error: Cannot connect to proxy server. Please check your internet connection.",u="NetworkError"):"AbortError"===d.name?(l="Request timeout: The authentication request took too long. Please try again.",u="TimeoutError"):d.message.includes("Failed to fetch")?(l="Connection failed: Unable to reach the proxy server. This may be due to network issues.",u="ConnectionError"):(l="Authentication failed: ".concat(d.message),u=d.name||"UnknownError"),e.a(2,{success:!1,message:l,error:u});case 8:return e.a(2)}},e,this,[[1,7]])})),function(e,t){return c.apply(this,arguments)})},{key:"searchSensors",value:function(){var e=r(t().m(function e(n){var o,r,s,a,i,c,l;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.authToken||this.credentials){e.n=1;break}return e.a(2,{success:!1,message:"Not authenticated. Please authenticate first.",error:"Authentication required",search_results:[],sensor_count:0});case 1:return e.p=1,this.logDiagnostic("PROXY_SEARCH_START","Searching for sensors through proxy",{sensorNames:n,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/search"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:n,username:null===(o=this.credentials)||void 0===o?void 0:o.accessKey,password:null===(r=this.credentials)||void 0===r?void 0:r.password,auth_provider:(null===(s=this.credentials)||void 0===s?void 0:s.authProvider)||"Seeq"})});case 2:if(a=e.v,this.logDiagnostic("PROXY_SEARCH_RESPONSE","Proxy search response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=4;break}return e.n=3,a.json();case 3:return i=e.v,this.logDiagnostic("PROXY_SEARCH_SUCCESS","Proxy search successful",{sensorCount:i.sensor_count,searchResults:i.search_results}),e.a(2,{success:!0,message:i.message||"Found ".concat(i.sensor_count," sensors"),search_results:i.search_results||[],sensor_count:i.sensor_count||0});case 4:return e.n=5,a.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_SEARCH_FAILED","Proxy search failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Search failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status),search_results:[],sensor_count:0});case 6:e.n=8;break;case 7:return e.p=7,l=e.v,this.logDiagnostic("PROXY_SEARCH_ERROR","Proxy search error",{error:l.message,errorName:l.name}),e.a(2,{success:!1,message:"Sensor search failed: ".concat(l.message),error:l.message,search_results:[],sensor_count:0});case 8:return e.a(2)}},e,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()},{key:"searchAndPullSensors",value:(i=r(t().m(function e(n,o,r){var s,a,i,c,l,u,d,g,v,h=arguments;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=h.length>3&&void 0!==h[3]?h[3]:"15min",e.p=1,this.logDiagnostic("PROXY_SEARCH_PULL_START","Searching and pulling sensor data through proxy",{sensorNames:n,startTime:o,endTime:r,grid:s,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/data"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:n,start_time:o,end_time:r,grid:s,username:null===(a=this.credentials)||void 0===a?void 0:a.accessKey,password:null===(i=this.credentials)||void 0===i?void 0:i.password,auth_provider:(null===(c=this.credentials)||void 0===c?void 0:c.authProvider)||"Seeq"})});case 2:if(l=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_RESPONSE","Proxy search and pull response received",{status:l.status,statusText:l.statusText}),!l.ok){e.n=4;break}return e.n=3,l.json();case 3:return d=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_SUCCESS","Proxy search and pull successful",{sensorCount:d.sensor_count,dataLength:(null===(u=d.data)||void 0===u?void 0:u.length)||0,dataColumns:d.data_columns}),e.a(2,{success:!0,message:d.message||"Successfully retrieved data for ".concat(d.sensor_count," sensors"),search_results:d.search_results||[],data:d.data||[],data_columns:d.data_columns||[],data_index:d.data_index||[],sensor_count:d.sensor_count||0,time_range:{start:o,end:r,grid:s}});case 4:return e.n=5,l.json().catch(function(){return{}});case 5:return g=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_FAILED","Proxy search and pull failed",{status:l.status,errorData:g}),e.a(2,{success:!1,message:g.message||"Search and pull failed with status ".concat(l.status),error:g.error||"HTTP ".concat(l.status),search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:o,end:r,grid:s}});case 6:e.n=8;break;case 7:return e.p=7,v=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_ERROR","Proxy search and pull error",{error:v.message,errorName:v.name}),e.a(2,{success:!1,message:"Search and pull operation failed: ".concat(v.message),error:v.message,search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:o,end:r,grid:s}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(e,t,n){return i.apply(this,arguments)})},{key:"getAuthStatus",value:function(){var e;return{isAuthenticated:!!this.authToken,user:null===(e=this.credentials)||void 0===e?void 0:e.accessKey}}},{key:"logout",value:(o=r(t().m(function e(){var n,o,r;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!this.authToken){e.n=2;break}return this.logDiagnostic("PROXY_LOGOUT_START","Logging out through proxy"),e.n=1,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:null===(n=this.credentials)||void 0===n?void 0:n.accessKey})});case 1:o=e.v,this.logDiagnostic("PROXY_LOGOUT_RESPONSE","Proxy logout response received",{status:o.status,statusText:o.statusText});case 2:e.n=4;break;case 3:e.p=3,r=e.v,this.logDiagnostic("PROXY_LOGOUT_ERROR","Proxy logout error",{error:r.message});case 4:return e.p=4,this.authToken=null,this.credentials=null,e.f(4);case 5:return e.a(2)}},e,this,[[0,3,4,5]])})),function(){return o.apply(this,arguments)})},{key:"getCredentials",value:function(){return this.credentials}},{key:"setCredentials",value:function(e){this.credentials=e}}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,o,i,c,l}();function l(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function s(n,o,r,s){var c=o&&o.prototype instanceof i?o:i,l=Object.create(c.prototype);return u(l,"_invoke",function(n,o,r){var s,i,c,l=0,u=r||[],d=!1,g={p:0,n:0,v:e,a:v,f:v.bind(e,4),d:function(t,n){return s=t,i=0,c=e,g.n=n,a}};function v(n,o){for(i=n,c=o,t=0;!d&&l&&!r&&t<u.length;t++){var r,s=u[t],v=g.p,h=s[2];n>3?(r=h===o)&&(c=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=v&&((r=n<2&&v<s[1])?(i=0,g.v=o,g.n=s[1]):v<h&&(r=n<3||s[0]>o||o>h)&&(s[4]=n,s[5]=o,g.n=h,i=0))}if(r||n>1)return a;throw d=!0,o}return function(r,u,h){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,h),i=u,c=h;(t=i<2?e:c)||!d;){s||(i?i<3?(i>1&&(g.n=-1),v(i,c)):g.n=c:g.v=c);try{if(l=2,s){if(i||(r="next"),t=s[r]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=s.return)&&t.call(s),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);s=e}else if((t=(d=g.n<0)?c:n.call(o,g))!==a)break}catch(t){s=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,r,s),!0),l}var a={};function i(){}function c(){}function d(){}t=Object.getPrototypeOf;var g=[][o]?t(t([][o]())):(u(t={},o,function(){return this}),t),v=d.prototype=i.prototype=Object.create(g);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,r,"GeneratorFunction")),e.prototype=Object.create(v),e}return c.prototype=d,u(v,"constructor",d),u(d,"constructor",c),c.displayName="GeneratorFunction",u(d,r,"GeneratorFunction"),u(v),u(v,r,"Generator"),u(v,o,function(){return this}),u(v,"toString",function(){return"[object Generator]"}),(l=function(){return{w:s,m:h}})()}function u(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}u=function(e,t,n,o){function s(t,n){u(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(s("next",0),s("throw",1),s("return",2))},u(e,t,n,o)}function d(e,t,n,o,r,s,a){try{var i=e[s](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(o,r)}function g(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var s=e.apply(t,n);function a(e){d(s,o,r,a,i,"next",e)}function i(e){d(s,o,r,a,i,"throw",e)}a(void 0)})}}var v="Loading...",h=null;function f(){return p.apply(this,arguments)}function p(){return(p=g(l().m(function e(){var t,n,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Attempting to load version info..."),e.n=1,fetch("./version.json");case 1:if(t=e.v,console.log("Relative path response status:",t.status),t.ok){e.n=3;break}return console.log("Relative path failed, trying full URL..."),e.n=2,fetch("https://adraughon.github.io/SqExcel/version.json");case 2:t=e.v,console.log("Full URL response status:",t.status);case 3:if(!t.ok){e.n=5;break}return e.n=4,t.json();case 4:n=e.v,console.log("Version data loaded:",n),v="".concat(n.version," - ").concat(n.description),e.n=6;break;case 5:console.error("Failed to load version.json, status:",t.status),v="Version info unavailable";case 6:e.n=8;break;case 7:e.p=7,o=e.v,console.error("Failed to load version info:",o),v="Version info unavailable";case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function m(){var e=document.getElementById("test-connection"),t=document.getElementById("authenticate"),n=document.getElementById("logout"),o=document.getElementById("search-sensors"),r=document.getElementById("pull-data");e&&(e.onclick=y),t&&(t.onclick=_),n&&(n.onclick=O),o&&(o.onclick=b),r&&(r.onclick=T),function(){var e=localStorage.getItem("seeq_credentials");if(e)try{var t=JSON.parse(e);document.getElementById("seeq-url").value=t.url||"",document.getElementById("seeq-access-key").value=t.accessKey||"",document.getElementById("seeq-password").value=t.password||"",document.getElementById("ignore-ssl").checked=t.ignoreSsl||!1;var n=new Date(t.timestamp);((new Date).getTime()-n.getTime())/36e5<24?(R(!0),P("Using saved credentials","info"),t.url&&(h=new c(t.url))):localStorage.removeItem("seeq_credentials")}catch(e){console.error("Failed to load saved credentials:",e),localStorage.removeItem("seeq_credentials")}}(),console.log("SqExcel Add-in Version: ".concat(v)),P("Add-in Version: ".concat(v),"info")}function y(){return w.apply(this,arguments)}function w(){return(w=g(l().m(function e(){var t,n,o,r;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null===(t=document.getElementById("seeq-url"))||void 0===t?void 0:t.value){e.n=1;break}return P("Please enter a Seeq server URL","error"),e.a(2);case 1:return P("Testing connection...","loading"),e.p=2,h=new c(n),e.n=3,h.testConnection();case 3:(o=e.v).success?(P(o.message,"success"),A(o,null),D("auth",o)):(P(o.message,"error"),q(o)),e.n=5;break;case 4:e.p=4,r=e.v,P("Connection test failed: ".concat(r),"error"),q({success:!1,message:r.toString(),error:r.toString()});case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function _(){return S.apply(this,arguments)}function S(){return(S=g(l().m(function e(){var t,n,o,r,s,a,i,u,d,g;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=null===(t=document.getElementById("seeq-url"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("seeq-access-key"))||void 0===n?void 0:n.value,i=null===(o=document.getElementById("seeq-password"))||void 0===o?void 0:o.value,u=null===(r=document.getElementById("ignore-ssl"))||void 0===r?void 0:r.checked,s&&a&&i){e.n=1;break}return P("Please fill in all required fields","error"),e.a(2);case 1:return P("Authenticating...","loading"),e.p=2,h||(h=new c(s)),e.n=3,h.authenticate(a,i,"Seeq",u);case 3:(d=e.v).success?(P("Authentication successful","success"),x(s,a,i,u),R(!0),D("auth",d)):P(d.message,"error"),e.n=5;break;case 4:e.p=4,g=e.v,P("Authentication failed: ".concat(g),"error");case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function b(){return k.apply(this,arguments)}function k(){return(k=g(l().m(function e(){var t,n,o,r,s;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value){e.n=1;break}return P("Please enter sensor names to search for","error"),e.a(2);case 1:if(0!==(o=n.split(",").map(function(e){return e.trim()}).filter(function(e){return e})).length){e.n=2;break}return P("Please enter valid sensor names","error"),e.a(2);case 2:if(P("Searching for sensors...","loading"),e.p=3,h){e.n=4;break}return P("Please test connection first","error"),e.a(2);case 4:return e.n=5,h.searchSensors(o);case 5:(r=e.v).success?(P("Found ".concat(r.sensor_count," sensors"),"success"),D("search",r),I(r.search_results)):P(r.message,"error"),e.n=7;break;case 6:e.p=6,s=e.v,P("Sensor search failed: ".concat(s),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function T(){return E.apply(this,arguments)}function E(){return(E=g(l().m(function e(){var t,n,o,r,s,a,i,c,u,d,g,v;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("start-time"))||void 0===n?void 0:n.value,i=null===(o=document.getElementById("end-time"))||void 0===o?void 0:o.value,c=null===(r=document.getElementById("grid-interval"))||void 0===r?void 0:r.value,s&&a&&i){e.n=1;break}return P("Please fill in all required fields","error"),e.a(2);case 1:if(u=s.split(",").map(function(e){return e.trim()}).filter(function(e){return e}),d=c||"15min",0!==u.length){e.n=2;break}return P("Please enter valid sensor names","error"),e.a(2);case 2:if(P("Pulling sensor data...","loading"),e.p=3,h){e.n=4;break}return P("Please test connection first","error"),e.a(2);case 4:return e.n=5,h.searchAndPullSensors(u,a,i,d);case 5:(g=e.v).success?(P("Retrieved data for ".concat(g.sensor_count," sensors"),"success"),D("data",g),C(g)):P(g.message,"error"),e.n=7;break;case 6:e.p=6,v=e.v,P("Data retrieval failed: ".concat(v),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function O(){localStorage.removeItem("seeq_credentials"),h&&h.logout(),R(!1),P("Logged out successfully","info"),document.getElementById("seeq-url").value="",document.getElementById("seeq-access-key").value="",document.getElementById("seeq-password").value="",document.getElementById("ignore-ssl").checked=!1}function P(e,t){var n=document.getElementById("auth-status");n&&(n.textContent=e,n.className="auth-status ".concat(t))}function R(e){var t=document.getElementById("test-connection"),n=document.getElementById("authenticate"),o=document.getElementById("logout"),r=document.getElementById("seeq-url"),s=document.getElementById("seeq-access-key"),a=document.getElementById("seeq-password"),i=document.getElementById("ignore-ssl");e?(t.style.display="none",n.style.display="none",o.style.display="inline-block",r.disabled=!0,s.disabled=!0,a.disabled=!0,i.disabled=!0):(t.style.display="inline-block",n.style.display="inline-block",o.style.display="none",r.disabled=!1,s.disabled=!1,a.disabled=!1,i.disabled=!1)}function x(e,t,n,o){var r={url:e,accessKey:t,password:n,ignoreSsl:o,timestamp:(new Date).toISOString()};localStorage.setItem("seeq_credentials",JSON.stringify(r))}function D(e,t){try{var n=JSON.stringify(t),o='=SEEQ_UPDATE_CACHE("'.concat(e,"\", '").concat(n,"')");Excel.run(function(){var e=g(l().m(function e(t){return l().w(function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[[o]],e.n=1,t.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("Could not update Excel cache automatically:",e),console.log("Manual cache update required:",o)})}catch(e){console.error("Failed to update Excel cache:",e)}}function I(e){var t=document.getElementById("search-results");if(t&&e.length>0){var n="\n      <h3>Search Results (".concat(e.length,' sensors)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Original Name</th>\n              <th>Seeq Name</th>\n              <th>ID</th>\n              <th>Type</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n    ');e.forEach(function(e){n+="\n        <tr>\n          <td>".concat(e.Original_Name||e.Name||"N/A","</td>\n          <td>").concat(e.Name||"N/A","</td>\n          <td>").concat(e.ID||"Not Found","</td>\n          <td>").concat(e.Type||"N/A","</td>\n          <td>").concat(e.Status||"Unknown","</td>\n        </tr>\n      ")}),n+="\n          </tbody>\n        </table>\n      </div>\n    ",t.innerHTML=n}}function C(e){var t=document.getElementById("data-results");if(t&&e.data&&e.data.length>0){var n=e.data.slice(0,10),o="\n      <h3>Data Results (".concat(e.data.length,' rows)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Timestamp</th>\n              ').concat(e.data_columns.map(function(e){return"<th>".concat(e,"</th>")}).join(""),"\n            </tr>\n          </thead>\n          <tbody>\n    ");n.forEach(function(t){o+="\n        <tr>\n          <td>".concat(t.Timestamp||t.index||"N/A","</td>\n          ").concat(e.data_columns.map(function(e){return"<td>".concat(void 0!==t[e]?t[e]:"N/A","</td>")}).join(""),"\n        </tr>\n      ")}),o+="\n          </tbody>\n        </table>\n        ".concat(e.data.length>10?"<p><em>Showing first 10 of ".concat(e.data.length," rows</em></p>"):"","\n      </div>\n    "),t.innerHTML=o}}function A(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=document.getElementById("diagnostics");if(o){var r=null===(t=h)||void 0===t?void 0:t.getDiagnostics();if(r){var s='\n    <div class="diagnostics-panel">\n      <h3>üîç Connection Diagnostics</h3>\n      <div class="diagnostic-section">\n        <h4>Environment Information</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>App Domain:</strong> '.concat(r.environment.appDomain,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Origin:</strong> ').concat(r.environment.origin,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Network Type:</strong> ').concat(r.environment.networkInfo.connectionType,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Online Status:</strong> ').concat(r.environment.networkInfo.online?"‚úÖ Online":"‚ùå Offline","\n          </div>\n        </div>\n      </div>\n  ");if(e.diagnostics&&(s+='\n      <div class="diagnostic-section">\n        <h4>Connection Test Results</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>Response Time:</strong> '.concat(e.diagnostics.request_timing,'ms\n          </div>\n          <div class="diagnostic-item">\n            <strong>Status Code:</strong> ').concat(e.status_code,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>CORS Status:</strong> ').concat(e.diagnostics.cors_status,"\n          </div>\n        </div>\n    "),e.diagnostics.response_headers&&(s+='\n        <div class="cors-headers">\n          <h5>CORS Headers:</h5>\n          <ul>\n      ',["access-control-allow-origin","access-control-allow-methods","access-control-allow-headers","access-control-allow-credentials"].forEach(function(t){var n=e.diagnostics.response_headers[t];s+="<li><strong>".concat(t,":</strong> ").concat(n||"Not set","</li>")}),s+="</ul></div>"),s+="</div>"),n&&n.diagnostics){if(s+='\n      <div class="diagnostic-section">\n        <h4>Authentication Endpoint Test</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>Response Time:</strong> '.concat(n.diagnostics.request_timing,'ms\n          </div>\n          <div class="diagnostic-item">\n            <strong>Status Code:</strong> ').concat(n.status_code,"\n          </div>\n        </div>\n    "),n.diagnostics.cors_analysis){var a=n.diagnostics.cors_analysis;s+='\n        <div class="cors-analysis">\n          <h5>CORS Configuration Analysis:</h5>\n          <div class="cors-status">\n            <div class="cors-item '.concat(a.allowsOrigin?"success":"error",'">\n              <strong>Origin Allowed:</strong> ').concat(a.allowsOrigin?"‚úÖ Yes":"‚ùå No",'\n            </div>\n            <div class="cors-item ').concat(a.allowsMethods?"success":"error",'">\n              <strong>Methods Allowed:</strong> ').concat(a.allowsMethods?"‚úÖ Yes":"‚ùå No",'\n            </div>\n            <div class="cors-item ').concat(a.allowsHeaders?"success":"error",'">\n              <strong>Headers Allowed:</strong> ').concat(a.allowsHeaders?"‚úÖ Yes":"‚ùå No","\n            </div>\n          </div>\n      "),a.issues.length>0&&(s+='\n          <div class="cors-issues">\n            <h6>Issues Found:</h6>\n            <ul>\n              '.concat(a.issues.map(function(e){return"<li>‚ùå ".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        ")),a.recommendations.length>0&&(s+='\n          <div class="cors-recommendations">\n            <h6>Recommendations:</h6>\n            <ul>\n              '.concat(a.recommendations.map(function(e){return"<li>üí° ".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        ")),s+="</div>"}s+="</div>"}r.recentLogs&&r.recentLogs.length>0&&(s+='\n      <div class="diagnostic-section">\n        <h4>Recent Diagnostic Logs</h4>\n        <div class="log-entries">\n    ',r.recentLogs.slice(-10).forEach(function(e){var t=new Date(e.timestamp).toLocaleTimeString();s+='\n        <div class="log-entry">\n          <span class="log-time">'.concat(t,'</span>\n          <span class="log-category">[').concat(e.category,']</span>\n          <span class="log-message">').concat(e.message,"</span>\n        </div>\n      ")}),s+="</div></div>"),s+='\n      <div class="diagnostic-actions">\n        <button onclick="clearDiagnostics()" class="btn-secondary">Clear Logs</button>\n        <button onclick="exportDiagnostics()" class="btn-secondary">Export Diagnostics</button>\n      </div>\n    </div>\n  ',o.innerHTML=s}}}function q(e){var t,n=document.getElementById("diagnostics");if(n){var o=null===(t=h)||void 0===t?void 0:t.getDiagnostics();if(o){var r='\n    <div class="diagnostics-panel error">\n      <h3>‚ùå Error Diagnostics</h3>\n      <div class="error-summary">\n        <h4>Error Summary</h4>\n        <div class="error-details">\n          <div class="error-item">\n            <strong>Error Message:</strong> '.concat(e.message,'\n          </div>\n          <div class="error-item">\n            <strong>Error Type:</strong> ').concat(e.error||"Unknown","\n          </div>\n        </div>\n      </div>\n  ");if(e.diagnostics&&e.diagnostics.error_analysis){var s=e.diagnostics.error_analysis;r+='\n      <div class="diagnostic-section">\n        <h4>Error Analysis</h4>\n        <div class="error-analysis">\n          <div class="analysis-item">\n            <strong>Error Type:</strong> '.concat(s.errorType,'\n          </div>\n          <div class="analysis-item">\n            <strong>Likely Cause:</strong> ').concat(s.likelyCause,'\n          </div>\n          <div class="analysis-flags">\n            <div class="flag ').concat(s.isCorsRelated?"active":"",'">CORS Related</div>\n            <div class="flag ').concat(s.isNetworkRelated?"active":"",'">Network Related</div>\n            <div class="flag ').concat(s.isSslRelated?"active":"",'">SSL Related</div>\n            <div class="flag ').concat(s.isAppDomainRelated?"active":"",'">AppDomain Related</div>\n          </div>\n        </div>\n    '),s.recommendations.length>0&&(r+='\n        <div class="recommendations">\n          <h5>Recommendations:</h5>\n          <ul>\n            '.concat(s.recommendations.map(function(e){return"<li>üí° ".concat(e,"</li>")}).join(""),"\n          </ul>\n        </div>\n      ")),r+="</div>"}r+='\n    <div class="diagnostic-section">\n      <h4>Environment Information</h4>\n      <div class="diagnostic-grid">\n        <div class="diagnostic-item">\n          <strong>App Domain:</strong> '.concat(o.environment.appDomain,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Origin:</strong> ').concat(o.environment.origin,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Network Type:</strong> ').concat(o.environment.networkInfo.connectionType,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Online Status:</strong> ').concat(o.environment.networkInfo.online?"‚úÖ Online":"‚ùå Offline","\n        </div>\n      </div>\n    </div>\n  "),r+='\n    <div class="diagnostic-actions">\n      <button onclick="clearDiagnostics()" class="btn-secondary">Clear Logs</button>\n      <button onclick="exportDiagnostics()" class="btn-secondary">Export Diagnostics</button>\n    </div>\n  </div>\n  ',n.innerHTML=r}}}Office.onReady(g(l().m(function e(){var t,n;return l().w(function(e){for(;;)switch(e.n){case 0:return t=document.getElementById("sideload-msg"),n=document.getElementById("app-body"),t&&(t.style.display="none"),n&&(n.style.display="flex"),e.n=1,f();case 1:m();case 2:return e.a(2)}},e)}))),window.clearDiagnostics=function(){h&&h.clearDiagnostics();var e=document.getElementById("diagnostics");e&&(e.innerHTML='<div class="diagnostics-panel"><p>Diagnostics cleared. Run a connection test to generate new diagnostics.</p></div>')},window.exportDiagnostics=function(){if(h){var e=h.getDiagnostics(),t={timestamp:(new Date).toISOString(),diagnostics:e,userAgent:navigator.userAgent,url:window.location.href},n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download="sqexcel-diagnostics-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}}}(),new URL(n(98362),n.b)}();
//# sourceMappingURL=taskpane.js.map