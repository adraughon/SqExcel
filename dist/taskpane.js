/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"b2fcbb086b4045eedf70.css"},98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(e(t)+" is not iterable")}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,s=function(){};return{s:s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw a}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,r,o,a){var c=r&&r.prototype instanceof u?r:u,l=Object.create(c.prototype);return s(l,"_invoke",function(n,r,o){var s,a,c,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return s=t,a=0,c=e,f.n=n,i}};function h(n,r){for(a=n,c=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,s=l[t],h=f.p,p=s[2];n>3?(o=p===r)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=h&&((o=n<2&&h<s[1])?(a=0,f.v=r,f.n=s[1]):h<p&&(o=n<3||s[0]>r||r>p)&&(s[4]=n,s[5]=r,f.n=p,a=0))}if(o||n>1)return i;throw d=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&h(l,p),a=l,c=p;(t=a<2?e:c)||!d;){s||(a?a<3?(a>1&&(f.n=-1),h(a,c)):f.n=c:f.v=c);try{if(u=2,s){if(a||(o="next"),t=s[o]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);s=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==i)break}catch(t){s=e,a=1,c=t}finally{u=1}}return{value:t,done:d}}}(n,o,a),!0),l}var i={};function u(){}function l(){}function d(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(s(t={},r,function(){return this}),t),h=d.prototype=u.prototype=Object.create(f);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return l.prototype=d,s(h,"constructor",d),s(d,"constructor",l),l.displayName="GeneratorFunction",s(d,a,"GeneratorFunction"),s(h),s(h,a,"Generator"),s(h,r,function(){return this}),s(h,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:p}})()}function s(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}s=function(e,t,n,r){function a(t,n){s(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},s(e,t,n,r)}function a(e,t,n,r,o,s,a){try{var c=e[s](a),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var s=e.apply(t,n);function c(e){a(s,r,o,c,i,"next",e)}function i(e){a(s,r,o,c,i,"throw",e)}c(void 0)})}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function u(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var d=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"authToken",null),u(this,"credentials",null),this.baseUrl=t.replace(/\/$/,"")},r=[{key:"testAuthEndpoint",value:(f=c(o().m(function e(){var t,n;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Testing authentication endpoint: ".concat(this.baseUrl,"/api/auth/login")),e.n=1,fetch("".concat(this.baseUrl,"/api/auth/login"),{method:"OPTIONS",headers:{Origin:window.location.origin,"Access-Control-Request-Method":"POST","Access-Control-Request-Headers":"Content-Type"}});case 1:return t=e.v,console.log("Auth endpoint OPTIONS response status: ".concat(t.status)),console.log("Auth endpoint CORS headers:",{"Access-Control-Allow-Origin":t.headers.get("Access-Control-Allow-Origin"),"Access-Control-Allow-Methods":t.headers.get("Access-Control-Allow-Methods"),"Access-Control-Allow-Headers":t.headers.get("Access-Control-Allow-Headers"),"Access-Control-Allow-Credentials":t.headers.get("Access-Control-Allow-Credentials")}),e.a(2,{success:!0,message:"Authentication endpoint is accessible",status_code:t.status});case 2:return e.p=2,n=e.v,console.error("Auth endpoint test error:",n),e.a(2,{success:!1,message:"Authentication endpoint test failed: ".concat(n.message),error:n.message})}},e,this,[[0,2]])})),function(){return f.apply(this,arguments)})},{key:"testCorsPreflight",value:(d=c(o().m(function e(){var t,n;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Testing CORS preflight to Seeq server: ".concat(this.baseUrl)),e.n=1,fetch("".concat(this.baseUrl,"/api/system/open-ping"),{method:"OPTIONS",headers:{Origin:window.location.origin,"Access-Control-Request-Method":"POST","Access-Control-Request-Headers":"Content-Type"}});case 1:return t=e.v,console.log("CORS preflight response status: ".concat(t.status)),console.log("CORS headers:",{"Access-Control-Allow-Origin":t.headers.get("Access-Control-Allow-Origin"),"Access-Control-Allow-Methods":t.headers.get("Access-Control-Allow-Methods"),"Access-Control-Allow-Headers":t.headers.get("Access-Control-Allow-Headers"),"Access-Control-Allow-Credentials":t.headers.get("Access-Control-Allow-Credentials")}),e.a(2,{success:!0,message:"CORS preflight successful",status_code:t.status});case 2:return e.p=2,n=e.v,console.error("CORS preflight error:",n),e.a(2,{success:!1,message:"CORS preflight failed: ".concat(n.message),error:n.message})}},e,this,[[0,2]])})),function(){return d.apply(this,arguments)})},{key:"testConnection",value:(l=c(o().m(function e(){var t,n;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Testing connection to Seeq server: ".concat(this.baseUrl)),e.n=1,this.testCorsPreflight();case 1:return e.v.success||console.warn("CORS preflight failed, but continuing with connection test"),e.n=2,fetch("".concat(this.baseUrl,"/api/system/open-ping"),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if(t=e.v,console.log("Connection test response status: ".concat(t.status)),console.log("Response headers:",t.headers),!t.ok){e.n=3;break}return console.log("Connection test successful"),e.a(2,{success:!0,message:"Server is reachable",status_code:t.status});case 3:return console.error("Connection test failed with status: ".concat(t.status)),e.a(2,{success:!1,message:"Server responded with status code: ".concat(t.status),status_code:t.status});case 4:e.n=10;break;case 5:if(e.p=5,n=e.v,console.error("Connection test error details:",n),"TypeError"!==n.name||!n.message.includes("fetch")){e.n=6;break}return e.a(2,{success:!1,message:"Cannot connect to server - connection refused. This may be due to CORS restrictions or network issues.",error:"ConnectionError"});case 6:if("AbortError"!==n.name){e.n=7;break}return e.a(2,{success:!1,message:"Connection timeout - the server took too long to respond.",error:"Timeout"});case 7:if(!n.message.includes("Failed to fetch")){e.n=8;break}return e.a(2,{success:!1,message:"Connection failed - unable to reach the server. This may be due to CORS restrictions, SSL issues, or network problems.",error:"FetchError"});case 8:if(!n.message.includes("Load failed")){e.n=9;break}return e.a(2,{success:!1,message:"Load failed - the connection request could not be completed. This may be due to CORS restrictions, SSL certificate issues, or network connectivity problems.",error:"LoadError"});case 9:return e.a(2,{success:!1,message:"Connection test failed: ".concat(n.message),error:n.message});case 10:return e.a(2)}},e,this,[[0,5]])})),function(){return l.apply(this,arguments)})},{key:"authenticate",value:(a=c(o().m(function e(t,n){var r,s,a,c,i,u,l,d=arguments;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return r=d.length>2&&void 0!==d[2]?d[2]:"Seeq",s=d.length>3&&void 0!==d[3]&&d[3],e.p=1,this.credentials={accessKey:t,password:n,authProvider:r,ignoreSslErrors:s},console.log("Attempting to authenticate with Seeq server: ".concat(this.baseUrl)),console.log("Using access key: ".concat(t,", auth provider: ").concat(r)),e.n=2,fetch("".concat(this.baseUrl,"/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:t,password:n})});case 2:if(a=e.v,console.log("Authentication response status: ".concat(a.status)),console.log("Response headers:",a.headers),!a.ok){e.n=3;break}return this.authToken="session",console.log("Authentication successful"),e.a(2,{success:!0,message:"Successfully authenticated as ".concat(t),user:t,server_url:this.baseUrl,token:this.authToken});case 3:return e.n=4,a.json().catch(function(){return{}});case 4:return c=e.v,console.error("Authentication failed with response:",c),e.a(2,{success:!1,message:c.message||"Authentication failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status)});case 5:e.n=7;break;case 6:return e.p=6,l=e.v,console.error("Authentication error details:",l),i="Authentication failed",u="Unknown","TypeError"===l.name&&l.message.includes("fetch")?(i="Network error: Cannot connect to Seeq server. Please check the server URL and ensure it's accessible.",u="NetworkError"):"AbortError"===l.name?(i="Request timeout: The authentication request took too long. Please try again.",u="TimeoutError"):l.message.includes("Failed to fetch")?(i="Connection failed: Unable to reach the Seeq server. This may be due to CORS restrictions, network issues, or an invalid server URL.",u="ConnectionError"):l.message.includes("Load failed")?(i="Load failed: The authentication request could not be completed. This may be due to CORS restrictions, SSL certificate issues, or network connectivity problems.",u="LoadError"):(i="Authentication failed: ".concat(l.message),u=l.name||"UnknownError"),e.a(2,{success:!1,message:i,error:u});case 7:return e.a(2)}},e,this,[[1,6]])})),function(e,t){return a.apply(this,arguments)})},{key:"searchSensors",value:function(){var e=c(o().m(function e(r){var s,a,c,i,u,l,d,f=this;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.authToken||this.credentials){e.n=1;break}return e.a(2,{success:!1,message:"Not authenticated. Please authenticate first.",error:"Authentication required",search_results:[],sensor_count:0});case 1:e.p=1,s=[],a=n(r),e.p=2,i=o().m(function e(){var t,n,r,a;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=c.value,e.p=1,e.n=2,fetch("".concat(f.baseUrl,"/api/items?Name=").concat(encodeURIComponent(t),"&Type=Signal"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});case 2:if(!(n=e.v).ok){e.n=4;break}return e.n=3,n.json();case 3:(r=e.v)&&r.length>0?r.forEach(function(e){s.push({ID:e.Id||e.id,Name:e.Name||e.name,Type:e.Type||"Signal",Original_Name:t,Status:"Found"})}):s.push({ID:"",Name:t,Type:"Signal",Original_Name:t,Status:"Not Found"}),e.n=5;break;case 4:s.push({ID:"",Name:t,Type:"Signal",Original_Name:t,Status:"Search Error: HTTP ".concat(n.status)});case 5:e.n=7;break;case 6:e.p=6,a=e.v,s.push({ID:"",Name:t,Type:"Signal",Original_Name:t,Status:"Search Error: ".concat(a.message)});case 7:return e.a(2)}},e,null,[[1,6]])}),a.s();case 3:if((c=a.n()).done){e.n=5;break}return e.d(t(i()),4);case 4:e.n=3;break;case 5:e.n=7;break;case 6:e.p=6,l=e.v,a.e(l);case 7:return e.p=7,a.f(),e.f(7);case 8:return u=s.filter(function(e){return e.ID}),e.a(2,{success:!0,message:"Found ".concat(u.length," sensors"),search_results:s,sensor_count:u.length});case 9:return e.p=9,d=e.v,e.a(2,{success:!1,message:"Sensor search failed: ".concat(d.message),error:d.message,search_results:[],sensor_count:0})}},e,this,[[2,6,7,8],[1,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:"searchAndPullSensors",value:(s=c(o().m(function e(r,s,a){var c,i,l,d,f,h,p,m,g,v,y,b=this,w=arguments;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return c=w.length>3&&void 0!==w[3]?w[3]:"15min",e.p=1,e.n=2,this.searchSensors(r);case 2:if((i=e.v).success){e.n=3;break}return e.a(2,{success:!1,message:i.message,error:i.error,search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:s,end:a,grid:c}});case 3:if(0!==(l=i.search_results.filter(function(e){return e.ID})).length){e.n=4;break}return e.a(2,{success:!1,message:"No valid sensors found to pull data from",error:"All sensors failed search",search_results:i.search_results,data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:s,end:a,grid:c}});case 4:e.p=4,d=[],f=[],h=n(l),e.p=5,m=o().m(function e(){var t,n,r,c,i;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=p.value,e.p=1,e.n=2,fetch("".concat(b.baseUrl,"/api/signals/").concat(t.ID,"/samples?start=").concat(encodeURIComponent(s),"&end=").concat(encodeURIComponent(a)),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});case 2:if(!(n=e.v).ok){e.n=4;break}return e.n=3,n.json();case 3:(r=e.v)&&r.length>0&&(c=t.Name||"Sensor_".concat(t.ID),f.includes(c)||f.push(c),r.forEach(function(e){var t=d.find(function(t){return t.Timestamp===e.Timestamp});t?t[c]=e.Value:d.push(u({Timestamp:e.Timestamp},c,e.Value))}));case 4:e.n=6;break;case 5:e.p=5,i=e.v,console.warn("Failed to get data for sensor ".concat(t.Name,":"),i);case 6:return e.a(2)}},e,null,[[1,5]])}),h.s();case 6:if((p=h.n()).done){e.n=8;break}return e.d(t(m()),7);case 7:e.n=6;break;case 8:e.n=10;break;case 9:e.p=9,g=e.v,h.e(g);case 10:return e.p=10,h.f(),e.f(10);case 11:return d.sort(function(e,t){return new Date(e.Timestamp).getTime()-new Date(t.Timestamp).getTime()}),e.a(2,{success:!0,message:"Successfully retrieved data for ".concat(l.length," sensors"),search_results:i.search_results,data:d,data_columns:f,data_index:d.map(function(e,t){return t.toString()}),sensor_count:l.length,time_range:{start:s,end:a,grid:c}});case 12:return e.p=12,v=e.v,e.a(2,{success:!1,message:"Failed to pull data: ".concat(v.message),error:"Data pull failed",search_results:i.search_results,data:[],data_columns:[],data_index:[],sensor_count:l.length,time_range:{start:s,end:a,grid:c}});case 13:return e.p=13,y=e.v,e.a(2,{success:!1,message:"Search and pull operation failed: ".concat(y.message),error:y.message,search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:s,end:a,grid:c}});case 14:return e.a(2)}},e,this,[[5,9,10,11],[4,12],[1,13]])})),function(e,t,n){return s.apply(this,arguments)})},{key:"getAuthStatus",value:function(){var e;return{isAuthenticated:!!this.authToken,user:null===(e=this.credentials)||void 0===e?void 0:e.accessKey}}},{key:"logout",value:function(){this.authToken=null,this.credentials=null}},{key:"getCredentials",value:function(){return this.credentials}},{key:"setCredentials",value:function(e){this.credentials=e}}],r&&i(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,s,a,l,d,f}();function f(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function s(n,r,o,s){var i=r&&r.prototype instanceof c?r:c,u=Object.create(i.prototype);return h(u,"_invoke",function(n,r,o){var s,c,i,u=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return s=t,c=0,i=e,f.n=n,a}};function h(n,r){for(c=n,i=r,t=0;!d&&u&&!o&&t<l.length;t++){var o,s=l[t],h=f.p,p=s[2];n>3?(o=p===r)&&(i=s[(c=s[4])?5:(c=3,3)],s[4]=s[5]=e):s[0]<=h&&((o=n<2&&h<s[1])?(c=0,f.v=r,f.n=s[1]):h<p&&(o=n<3||s[0]>r||r>p)&&(s[4]=n,s[5]=r,f.n=p,c=0))}if(o||n>1)return a;throw d=!0,r}return function(o,l,p){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&h(l,p),c=l,i=p;(t=c<2?e:i)||!d;){s||(c?c<3?(c>1&&(f.n=-1),h(c,i)):f.n=i:f.v=i);try{if(u=2,s){if(c||(o="next"),t=s[o]){if(!(t=t.call(s,i)))throw TypeError("iterator result is not an object");if(!t.done)return t;i=t.value,c<2&&(c=0)}else 1===c&&(t=s.return)&&t.call(s),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);s=e}else if((t=(d=f.n<0)?i:n.call(r,f))!==a)break}catch(t){s=e,c=1,i=t}finally{u=1}}return{value:t,done:d}}}(n,o,s),!0),u}var a={};function c(){}function i(){}function u(){}t=Object.getPrototypeOf;var l=[][r]?t(t([][r]())):(h(t={},r,function(){return this}),t),d=u.prototype=c.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,h(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return i.prototype=u,h(d,"constructor",u),h(u,"constructor",i),i.displayName="GeneratorFunction",h(u,o,"GeneratorFunction"),h(d),h(d,o,"Generator"),h(d,r,function(){return this}),h(d,"toString",function(){return"[object Generator]"}),(f=function(){return{w:s,m:p}})()}function h(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}h=function(e,t,n,r){function s(t,n){h(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(s("next",0),s("throw",1),s("return",2))},h(e,t,n,r)}function p(e,t,n,r,o,s,a){try{var c=e[s](a),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var s=e.apply(t,n);function a(e){p(s,r,o,a,c,"next",e)}function c(e){p(s,r,o,a,c,"throw",e)}a(void 0)})}}var g="1.0.0.2 - Enhanced Error Handling & CORS Debugging",v=null;function y(){return b.apply(this,arguments)}function b(){return(b=m(f().m(function e(){var t,n,r,o,s;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null===(t=document.getElementById("seeq-url"))||void 0===t?void 0:t.value){e.n=1;break}return _("Please enter a Seeq server URL","error"),e.a(2);case 1:return _("Testing connection...","loading"),e.p=2,v=new d(n),e.n=3,v.testConnection();case 3:if(!(r=e.v).success){e.n=5;break}return _(r.message,"success"),_("Testing authentication endpoint...","loading"),e.n=4,v.testAuthEndpoint();case 4:(o=e.v).success?_("".concat(r.message," - ").concat(o.message),"success"):_("".concat(r.message," - Warning: ").concat(o.message),"warning"),P("auth",r),e.n=6;break;case 5:_(r.message,"error");case 6:e.n=8;break;case 7:e.p=7,s=e.v,_("Connection test failed: ".concat(s),"error");case 8:return e.a(2)}},e,null,[[2,7]])}))).apply(this,arguments)}function w(){return S.apply(this,arguments)}function S(){return(S=m(f().m(function e(){var t,n,r,o,s,a,c,i,u,l;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=null===(t=document.getElementById("seeq-url"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("seeq-access-key"))||void 0===n?void 0:n.value,c=null===(r=document.getElementById("seeq-password"))||void 0===r?void 0:r.value,i=null===(o=document.getElementById("ignore-ssl"))||void 0===o?void 0:o.checked,s&&a&&c){e.n=1;break}return _("Please fill in all required fields","error"),e.a(2);case 1:return _("Authenticating...","loading"),e.p=2,v||(v=new d(s)),e.n=3,v.authenticate(a,c,"Seeq",i);case 3:(u=e.v).success?(_("Authentication successful","success"),I(s,a,c,i),O(!0),P("auth",u)):_(u.message,"error"),e.n=5;break;case 4:e.p=4,l=e.v,_("Authentication failed: ".concat(l),"error");case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function k(){return T.apply(this,arguments)}function T(){return(T=m(f().m(function e(){var t,n,r,o,s;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value){e.n=1;break}return _("Please enter sensor names to search for","error"),e.a(2);case 1:if(0!==(r=n.split(",").map(function(e){return e.trim()}).filter(function(e){return e})).length){e.n=2;break}return _("Please enter valid sensor names","error"),e.a(2);case 2:if(_("Searching for sensors...","loading"),e.p=3,v){e.n=4;break}return _("Please test connection first","error"),e.a(2);case 4:return e.n=5,v.searchSensors(r);case 5:(o=e.v).success?(_("Found ".concat(o.sensor_count," sensors"),"success"),P("search",o),N(o.search_results)):_(o.message,"error"),e.n=7;break;case 6:e.p=6,s=e.v,_("Sensor search failed: ".concat(s),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function E(){return A.apply(this,arguments)}function A(){return(A=m(f().m(function e(){var t,n,r,o,s,a,c,i,u,l,d,h;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("start-time"))||void 0===n?void 0:n.value,c=null===(r=document.getElementById("end-time"))||void 0===r?void 0:r.value,i=null===(o=document.getElementById("grid-interval"))||void 0===o?void 0:o.value,s&&a&&c){e.n=1;break}return _("Please fill in all required fields","error"),e.a(2);case 1:if(u=s.split(",").map(function(e){return e.trim()}).filter(function(e){return e}),l=i||"15min",0!==u.length){e.n=2;break}return _("Please enter valid sensor names","error"),e.a(2);case 2:if(_("Pulling sensor data...","loading"),e.p=3,v){e.n=4;break}return _("Please test connection first","error"),e.a(2);case 4:return e.n=5,v.searchAndPullSensors(u,a,c,l);case 5:(d=e.v).success?(_("Retrieved data for ".concat(d.sensor_count," sensors"),"success"),P("data",d),q(d)):_(d.message,"error"),e.n=7;break;case 6:e.p=6,h=e.v,_("Data retrieval failed: ".concat(h),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function C(){localStorage.removeItem("seeq_credentials"),v&&v.logout(),O(!1),_("Logged out successfully","info"),document.getElementById("seeq-url").value="",document.getElementById("seeq-access-key").value="",document.getElementById("seeq-password").value="",document.getElementById("ignore-ssl").checked=!1}function _(e,t){var n=document.getElementById("auth-status");n&&(n.textContent=e,n.className="auth-status ".concat(t))}function O(e){var t=document.getElementById("test-connection"),n=document.getElementById("authenticate"),r=document.getElementById("logout"),o=document.getElementById("seeq-url"),s=document.getElementById("seeq-access-key"),a=document.getElementById("seeq-password"),c=document.getElementById("ignore-ssl");e?(t.style.display="none",n.style.display="none",r.style.display="inline-block",o.disabled=!0,s.disabled=!0,a.disabled=!0,c.disabled=!0):(t.style.display="inline-block",n.style.display="inline-block",r.style.display="none",o.disabled=!1,s.disabled=!1,a.disabled=!1,c.disabled=!1)}function I(e,t,n,r){var o={url:e,accessKey:t,password:n,ignoreSsl:r,timestamp:(new Date).toISOString()};localStorage.setItem("seeq_credentials",JSON.stringify(o))}function P(e,t){try{var n=JSON.stringify(t),r='=SEEQ_UPDATE_CACHE("'.concat(e,"\", '").concat(n,"')");Excel.run(function(){var e=m(f().m(function e(t){return f().w(function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[[r]],e.n=1,t.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("Could not update Excel cache automatically:",e),console.log("Manual cache update required:",r)})}catch(e){console.error("Failed to update Excel cache:",e)}}function N(e){var t=document.getElementById("search-results");if(t&&e.length>0){var n="\n      <h3>Search Results (".concat(e.length,' sensors)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Original Name</th>\n              <th>Seeq Name</th>\n              <th>ID</th>\n              <th>Type</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n    ');e.forEach(function(e){n+="\n        <tr>\n          <td>".concat(e.Original_Name||e.Name||"N/A","</td>\n          <td>").concat(e.Name||"N/A","</td>\n          <td>").concat(e.ID||"Not Found","</td>\n          <td>").concat(e.Type||"N/A","</td>\n          <td>").concat(e.Status||"Unknown","</td>\n        </tr>\n      ")}),n+="\n          </tbody>\n        </table>\n      </div>\n    ",t.innerHTML=n}}function q(e){var t=document.getElementById("data-results");if(t&&e.data&&e.data.length>0){var n=e.data.slice(0,10),r="\n      <h3>Data Results (".concat(e.data.length,' rows)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Timestamp</th>\n              ').concat(e.data_columns.map(function(e){return"<th>".concat(e,"</th>")}).join(""),"\n            </tr>\n          </thead>\n          <tbody>\n    ");n.forEach(function(t){r+="\n        <tr>\n          <td>".concat(t.Timestamp||t.index||"N/A","</td>\n          ").concat(e.data_columns.map(function(e){return"<td>".concat(void 0!==t[e]?t[e]:"N/A","</td>")}).join(""),"\n        </tr>\n      ")}),r+="\n          </tbody>\n        </table>\n        ".concat(e.data.length>10?"<p><em>Showing first 10 of ".concat(e.data.length," rows</em></p>"):"","\n      </div>\n    "),t.innerHTML=r}}Office.onReady(function(){var e,t,n,r,o;document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",e=document.getElementById("test-connection"),t=document.getElementById("authenticate"),n=document.getElementById("logout"),r=document.getElementById("search-sensors"),o=document.getElementById("pull-data"),e&&(e.onclick=y),t&&(t.onclick=w),n&&(n.onclick=C),r&&(r.onclick=k),o&&(o.onclick=E),function(){var e=localStorage.getItem("seeq_credentials");if(e)try{var t=JSON.parse(e);document.getElementById("seeq-url").value=t.url||"",document.getElementById("seeq-access-key").value=t.accessKey||"",document.getElementById("seeq-password").value=t.password||"",document.getElementById("ignore-ssl").checked=t.ignoreSsl||!1;var n=new Date(t.timestamp);((new Date).getTime()-n.getTime())/36e5<24?(O(!0),_("Using saved credentials","info"),t.url&&(v=new d(t.url))):localStorage.removeItem("seeq_credentials")}catch(e){console.error("Failed to load saved credentials:",e),localStorage.removeItem("seeq_credentials")}}(),console.log("SqExcel Add-in Version: ".concat(g)),_("Add-in Version: ".concat(g),"info")})}(),new URL(n(58394),n.b),new URL(n(98362),n.b)}();
//# sourceMappingURL=taskpane.js.map