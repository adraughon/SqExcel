/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){var e,r,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function i(t,o,s,a){var i=o&&o.prototype instanceof l?o:l,u=Object.create(i.prototype);return n(u,"_invoke",function(t,n,o){var s,a,i,l=0,u=o||[],d=!1,g={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return s=t,a=0,i=e,g.n=n,c}};function h(t,n){for(a=t,i=n,r=0;!d&&l&&!o&&r<u.length;r++){var o,s=u[r],h=g.p,v=s[2];t>3?(o=v===n)&&(i=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=h&&((o=t<2&&h<s[1])?(a=0,g.v=n,g.n=s[1]):h<v&&(o=t<3||s[0]>n||n>v)&&(s[4]=t,s[5]=n,g.n=v,a=0))}if(o||t>1)return c;throw d=!0,n}return function(o,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,v),a=u,i=v;(r=a<2?e:i)||!d;){s||(a?a<3?(a>1&&(g.n=-1),h(a,i)):g.n=i:g.v=i);try{if(l=2,s){if(a||(o="next"),r=s[o]){if(!(r=r.call(s,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=s.return)&&r.call(s),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);s=e}else if((r=(d=g.n<0)?i:t.call(n,g))!==c)break}catch(t){s=e,a=1,i=t}finally{l=1}}return{value:r,done:d}}}(t,s,a),!0),u}var c={};function l(){}function u(){}function d(){}r=Object.getPrototypeOf;var g=[][s]?r(r([][s]())):(n(r={},s,function(){return this}),r),h=d.prototype=l.prototype=Object.create(g);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,n(e,a,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,n(h,"constructor",d),n(d,"constructor",u),u.displayName="GeneratorFunction",n(d,a,"GeneratorFunction"),n(h),n(h,a,"Generator"),n(h,s,function(){return this}),n(h,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:v}})()}function n(e,t,r,o){var s=Object.defineProperty;try{s({},"",{})}catch(e){s=0}n=function(e,t,r,o){function a(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?s?s(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},n(e,t,r,o)}function r(e,t,n,r,o,s,a){try{var i=e[s](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(o,s){var a=e.apply(t,n);function i(e){r(a,o,s,i,c,"next",e)}function c(e){r(a,o,s,i,c,"throw",e)}i(void 0)})}}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function a(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var c=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a(this,"authToken",null),a(this,"credentials",null),a(this,"diagnosticLog",[]),this.seeqServerUrl=t.replace(/\/$/,""),this.proxyUrl="https://sqexcel.up.railway.app",this.logDiagnostic("CLIENT_INIT","SeeqAPIClient initialized with proxy: ".concat(this.proxyUrl,", Seeq server: ").concat(this.seeqServerUrl))},n=[{key:"logDiagnostic",value:function(e,t,n){var r={timestamp:(new Date).toISOString(),category:e,message:t,data:n,userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()};this.diagnosticLog.push(r),console.log("[".concat(e,"] ").concat(t),n||"")}},{key:"detectAppDomain",value:function(){try{return"undefined"!=typeof Office&&Office.context?"Office.js - ".concat(Office.context.host||"Unknown Host"):"https:"===window.location.protocol?"HTTPS Web Context":"http:"===window.location.protocol?"HTTP Web Context":"file:"===window.location.protocol?"File Protocol Context":"Unknown Context - ".concat(window.location.protocol)}catch(e){return"Error detecting context: ".concat(e)}}},{key:"getNetworkInfo",value:function(){try{var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return{online:navigator.onLine,connectionType:(null==e?void 0:e.effectiveType)||"unknown",downlink:(null==e?void 0:e.downlink)||"unknown",rtt:(null==e?void 0:e.rtt)||"unknown"}}catch(e){return{online:navigator.onLine,error:e.toString()}}}},{key:"getDiagnostics",value:function(){return{clientInfo:{proxyUrl:this.proxyUrl,seeqServerUrl:this.seeqServerUrl,isAuthenticated:!!this.authToken,diagnosticLogCount:this.diagnosticLog.length},environment:{userAgent:navigator.userAgent,origin:window.location.origin,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo(),timestamp:(new Date).toISOString()},recentLogs:this.diagnosticLog.slice(-20)}}},{key:"clearDiagnostics",value:function(){this.diagnosticLog=[],this.logDiagnostic("DIAGNOSTICS_CLEARED","Diagnostic logs cleared")}},{key:"testConnection",value:(u=o(t().m(function e(){var n,r,o,s,a,i,c,l,u,d,g;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return n=Date.now(),r="".concat(this.proxyUrl,"/api/seeq/test-connection"),this.logDiagnostic("PROXY_CONNECTION_TEST_START","Testing connection to proxy server: ".concat(this.proxyUrl),{url:r,seeqServerUrl:this.seeqServerUrl,appDomain:this.detectAppDomain(),networkInfo:this.getNetworkInfo()}),e.p=1,e.n=2,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl})});case 2:if(o=e.v,s=Date.now()-n,a={},o.headers.forEach(function(e,t){a[t]=e}),this.logDiagnostic("PROXY_CONNECTION_RESPONSE","Proxy connection test response received",{status:o.status,statusText:o.statusText,requestTime:s,allHeaders:a,url:o.url}),!o.ok){e.n=4;break}return e.n=3,o.json();case 3:return i=e.v,this.logDiagnostic("PROXY_CONNECTION_SUCCESS","Proxy connection test successful",i),e.a(2,{success:!0,message:i.message||"Proxy server is reachable and can connect to Seeq",status_code:o.status,diagnostics:{response_headers:a,request_timing:s,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 4:return e.n=5,o.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_CONNECTION_FAILED","Proxy connection test failed with status: ".concat(o.status),{status:o.status,statusText:o.statusText,headers:a,errorData:c}),e.a(2,{success:!1,message:c.message||"Proxy server responded with status code: ".concat(o.status),status_code:o.status,error:c.error||"HTTP ".concat(o.status),diagnostics:{response_headers:a,request_timing:s,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 6:e.n=8;break;case 7:return e.p=7,g=e.v,l=Date.now()-n,this.logDiagnostic("PROXY_CONNECTION_ERROR","Proxy connection test error",{error:g.message,errorName:g.name,errorStack:g.stack,requestTime:l,url:r}),u="Proxy connection test failed",d="Unknown","TypeError"===g.name&&g.message.includes("fetch")?(u="Cannot connect to proxy server - connection refused. This may be due to network issues.",d="ConnectionError"):"AbortError"===g.name?(u="Connection timeout - the proxy server took too long to respond.",d="Timeout"):g.message.includes("Failed to fetch")?(u="Connection failed - unable to reach the proxy server. This may be due to network problems.",d="FetchError"):(u="Proxy connection test failed: ".concat(g.message),d=g.message),e.a(2,{success:!1,message:u,error:d,diagnostics:{request_timing:l,user_agent:navigator.userAgent,origin:window.location.origin,app_domain:this.detectAppDomain(),network_type:this.getNetworkInfo().connectionType,cors_status:"OK"}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(){return u.apply(this,arguments)})},{key:"authenticate",value:(l=o(t().m(function e(n,r){var o,s,a,i,c,l,u,d,g,h=arguments;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return o=h.length>2&&void 0!==h[2]?h[2]:"Seeq",s=h.length>3&&void 0!==h[3]&&h[3],e.p=1,this.credentials={accessKey:n,password:r,authProvider:o,ignoreSslErrors:s,seeq_url:this.seeqServerUrl},this.logDiagnostic("PROXY_AUTH_START","Attempting to authenticate through proxy: ".concat(this.proxyUrl),{seeqServerUrl:this.seeqServerUrl,accessKey:n,authProvider:o}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:n,password:r,auth_provider:o,ignore_ssl_errors:s})});case 2:if(a=e.v,this.logDiagnostic("PROXY_AUTH_RESPONSE","Proxy authentication response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=8;break}return e.n=3,a.json();case 3:return i=e.v,this.authToken=i.token||"authenticated",this.logDiagnostic("PROXY_AUTH_SUCCESS","Proxy authentication successful",{user:i.user,server_url:i.server_url}),e.p=4,e.n=5,this.storeCredentialsForExcel();case 5:e.n=7;break;case 6:e.p=6,d=e.v,console.warn("Failed to store credentials for Excel functions:",d);case 7:return e.a(2,{success:!0,message:i.message||"Successfully authenticated as ".concat(n),user:i.user||n,server_url:i.server_url||this.seeqServerUrl,token:this.authToken||void 0});case 8:return e.n=9,a.json().catch(function(){return{}});case 9:return c=e.v,this.logDiagnostic("PROXY_AUTH_FAILED","Proxy authentication failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Authentication failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status)});case 10:e.n=12;break;case 11:return e.p=11,g=e.v,this.logDiagnostic("PROXY_AUTH_ERROR","Proxy authentication error",{error:g.message,errorName:g.name}),l="Authentication failed",u="Unknown","TypeError"===g.name&&g.message.includes("fetch")?(l="Network error: Cannot connect to proxy server. Please check your internet connection.",u="NetworkError"):"AbortError"===g.name?(l="Request timeout: The authentication request took too long. Please try again.",u="TimeoutError"):g.message.includes("Failed to fetch")?(l="Connection failed: Unable to reach the proxy server. This may be due to network issues.",u="ConnectionError"):(l="Authentication failed: ".concat(g.message),u=g.name||"UnknownError"),e.a(2,{success:!1,message:l,error:u});case 12:return e.a(2)}},e,this,[[4,6],[1,11]])})),function(e,t){return l.apply(this,arguments)})},{key:"storeCredentialsForExcel",value:(c=o(t().m(function e(){var n,r;return t().w(function(e){for(;;)switch(e.n){case 0:if(this.credentials){e.n=1;break}throw new Error("No credentials available to store");case 1:return e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/credentials"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:this.seeqServerUrl,accessKey:this.credentials.accessKey,password:this.credentials.password,authProvider:this.credentials.authProvider,ignoreSslErrors:this.credentials.ignoreSslErrors,timestamp:(new Date).toISOString()})});case 2:if((n=e.v).ok){e.n=4;break}return e.n=3,n.json().catch(function(){return{}});case 3:throw r=e.v,new Error("Failed to store credentials: ".concat(r.error||n.statusText));case 4:return e.a(2)}},e,this)})),function(){return c.apply(this,arguments)})},{key:"searchSensors",value:function(){var e=o(t().m(function e(n){var r,o,s,a,i,c,l;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(this.authToken||this.credentials){e.n=1;break}return e.a(2,{success:!1,message:"Not authenticated. Please authenticate first.",error:"Authentication required",search_results:[],sensor_count:0});case 1:return e.p=1,this.logDiagnostic("PROXY_SEARCH_START","Searching for sensors through proxy",{sensorNames:n,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/search"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:n,username:null===(r=this.credentials)||void 0===r?void 0:r.accessKey,password:null===(o=this.credentials)||void 0===o?void 0:o.password,auth_provider:(null===(s=this.credentials)||void 0===s?void 0:s.authProvider)||"Seeq"})});case 2:if(a=e.v,this.logDiagnostic("PROXY_SEARCH_RESPONSE","Proxy search response received",{status:a.status,statusText:a.statusText}),!a.ok){e.n=4;break}return e.n=3,a.json();case 3:return i=e.v,this.logDiagnostic("PROXY_SEARCH_SUCCESS","Proxy search successful",{sensorCount:i.sensor_count,searchResults:i.search_results}),e.a(2,{success:!0,message:i.message||"Found ".concat(i.sensor_count," sensors"),search_results:i.search_results||[],sensor_count:i.sensor_count||0});case 4:return e.n=5,a.json().catch(function(){return{}});case 5:return c=e.v,this.logDiagnostic("PROXY_SEARCH_FAILED","Proxy search failed",{status:a.status,errorData:c}),e.a(2,{success:!1,message:c.message||"Search failed with status ".concat(a.status),error:c.error||"HTTP ".concat(a.status),search_results:[],sensor_count:0});case 6:e.n=8;break;case 7:return e.p=7,l=e.v,this.logDiagnostic("PROXY_SEARCH_ERROR","Proxy search error",{error:l.message,errorName:l.name}),e.a(2,{success:!1,message:"Sensor search failed: ".concat(l.message),error:l.message,search_results:[],sensor_count:0});case 8:return e.a(2)}},e,this,[[1,7]])}));return function(t){return e.apply(this,arguments)}}()},{key:"searchAndPullSensors",value:(i=o(t().m(function e(n,r,o){var s,a,i,c,l,u,d,g,h,v=arguments;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return s=v.length>3&&void 0!==v[3]?v[3]:"15min",e.p=1,this.logDiagnostic("PROXY_SEARCH_PULL_START","Searching and pulling sensor data through proxy",{sensorNames:n,startTime:r,endTime:o,grid:s,seeqServerUrl:this.seeqServerUrl}),e.n=2,fetch("".concat(this.proxyUrl,"/api/seeq/data"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,sensor_names:n,start_time:r,end_time:o,grid:s,username:null===(a=this.credentials)||void 0===a?void 0:a.accessKey,password:null===(i=this.credentials)||void 0===i?void 0:i.password,auth_provider:(null===(c=this.credentials)||void 0===c?void 0:c.authProvider)||"Seeq"})});case 2:if(l=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_RESPONSE","Proxy search and pull response received",{status:l.status,statusText:l.statusText}),!l.ok){e.n=4;break}return e.n=3,l.json();case 3:return d=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_SUCCESS","Proxy search and pull successful",{sensorCount:d.sensor_count,dataLength:(null===(u=d.data)||void 0===u?void 0:u.length)||0,dataColumns:d.data_columns}),e.a(2,{success:!0,message:d.message||"Successfully retrieved data for ".concat(d.sensor_count," sensors"),search_results:d.search_results||[],data:d.data||[],data_columns:d.data_columns||[],data_index:d.data_index||[],sensor_count:d.sensor_count||0,time_range:{start:r,end:o,grid:s}});case 4:return e.n=5,l.json().catch(function(){return{}});case 5:return g=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_FAILED","Proxy search and pull failed",{status:l.status,errorData:g}),e.a(2,{success:!1,message:g.message||"Search and pull failed with status ".concat(l.status),error:g.error||"HTTP ".concat(l.status),search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:r,end:o,grid:s}});case 6:e.n=8;break;case 7:return e.p=7,h=e.v,this.logDiagnostic("PROXY_SEARCH_PULL_ERROR","Proxy search and pull error",{error:h.message,errorName:h.name}),e.a(2,{success:!1,message:"Search and pull operation failed: ".concat(h.message),error:h.message,search_results:[],data:[],data_columns:[],data_index:[],sensor_count:0,time_range:{start:r,end:o,grid:s}});case 8:return e.a(2)}},e,this,[[1,7]])})),function(e,t,n){return i.apply(this,arguments)})},{key:"getAuthStatus",value:function(){var e;return{isAuthenticated:!!this.authToken,user:null===(e=this.credentials)||void 0===e?void 0:e.accessKey}}},{key:"logout",value:(r=o(t().m(function e(){var n,r,o,s;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,!this.authToken){e.n=2;break}return this.logDiagnostic("PROXY_LOGOUT_START","Logging out through proxy"),e.n=1,fetch("".concat(this.proxyUrl,"/api/seeq/auth"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({seeq_url:this.seeqServerUrl,username:null===(n=this.credentials)||void 0===n?void 0:n.accessKey})});case 1:r=e.v,this.logDiagnostic("PROXY_LOGOUT_RESPONSE","Proxy logout response received",{status:r.status,statusText:r.statusText});case 2:return e.p=2,e.n=3,fetch("".concat(this.proxyUrl,"/api/seeq/credentials"),{method:"DELETE",headers:{"Content-Type":"application/json"}});case 3:e.n=5;break;case 4:e.p=4,o=e.v,console.warn("Failed to clear credentials from backend:",o);case 5:e.n=7;break;case 6:e.p=6,s=e.v,this.logDiagnostic("PROXY_LOGOUT_ERROR","Proxy logout error",{error:s.message});case 7:return e.p=7,this.authToken=null,this.credentials=null,e.f(7);case 8:return e.a(2)}},e,this,[[2,4],[0,6,7,8]])})),function(){return r.apply(this,arguments)})},{key:"getCredentials",value:function(){return this.credentials}},{key:"setCredentials",value:function(e){this.credentials=e}}],n&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r,i,c,l,u}();function l(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function s(n,r,o,s){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return u(l,"_invoke",function(n,r,o){var s,i,c,l=0,u=o||[],d=!1,g={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return s=t,i=0,c=e,g.n=n,a}};function h(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,s=u[t],h=g.p,v=s[2];n>3?(o=v===r)&&(c=s[(i=s[4])?5:(i=3,3)],s[4]=s[5]=e):s[0]<=h&&((o=n<2&&h<s[1])?(i=0,g.v=r,g.n=s[1]):h<v&&(o=n<3||s[0]>r||r>v)&&(s[4]=n,s[5]=r,g.n=v,i=0))}if(o||n>1)return a;throw d=!0,r}return function(o,u,v){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,v),i=u,c=v;(t=i<2?e:c)||!d;){s||(i?i<3?(i>1&&(g.n=-1),h(i,c)):g.n=c:g.v=c);try{if(l=2,s){if(i||(o="next"),t=s[o]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=s.return)&&t.call(s),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);s=e}else if((t=(d=g.n<0)?c:n.call(r,g))!==a)break}catch(t){s=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,s),!0),l}var a={};function i(){}function c(){}function d(){}t=Object.getPrototypeOf;var g=[][r]?t(t([][r]())):(u(t={},r,function(){return this}),t),h=d.prototype=i.prototype=Object.create(g);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,u(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=d,u(h,"constructor",d),u(d,"constructor",c),c.displayName="GeneratorFunction",u(d,o,"GeneratorFunction"),u(h),u(h,o,"Generator"),u(h,r,function(){return this}),u(h,"toString",function(){return"[object Generator]"}),(l=function(){return{w:s,m:v}})()}function u(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}u=function(e,t,n,r){function s(t,n){u(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(s("next",0),s("throw",1),s("return",2))},u(e,t,n,r)}function d(e,t,n,r,o,s,a){try{var i=e[s](a),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var s=e.apply(t,n);function a(e){d(s,r,o,a,i,"next",e)}function i(e){d(s,r,o,a,i,"throw",e)}a(void 0)})}}var h="Loading...",v=null;function p(){return f.apply(this,arguments)}function f(){return(f=g(l().m(function e(){var t,n,r;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("Attempting to load version info..."),e.n=1,fetch("./version.json");case 1:if(t=e.v,console.log("Relative path response status:",t.status),t.ok){e.n=3;break}return console.log("Relative path failed, trying full URL..."),e.n=2,fetch("https://adraughon.github.io/SqExcel/version.json");case 2:t=e.v,console.log("Full URL response status:",t.status);case 3:if(!t.ok){e.n=5;break}return e.n=4,t.json();case 4:n=e.v,console.log("Version data loaded:",n),h="".concat(n.version," - ").concat(n.description),e.n=6;break;case 5:console.error("Failed to load version.json, status:",t.status),h="Version info unavailable";case 6:e.n=8;break;case 7:e.p=7,r=e.v,console.error("Failed to load version info:",r),h="Version info unavailable";case 8:return e.a(2)}},e,null,[[0,7]])}))).apply(this,arguments)}function m(){var e=document.getElementById("test-connection"),t=document.getElementById("authenticate"),n=document.getElementById("logout"),r=document.getElementById("search-sensors"),o=document.getElementById("pull-data");e&&(e.onclick=y),t&&(t.onclick=S),n&&(n.onclick=O),r&&(r.onclick=b),o&&(o.onclick=E),function(){var e=localStorage.getItem("seeq_credentials");if(e)try{var t=JSON.parse(e);document.getElementById("seeq-url").value=t.url||"",document.getElementById("seeq-access-key").value=t.accessKey||"",document.getElementById("seeq-password").value=t.password||"",document.getElementById("ignore-ssl").checked=t.ignoreSsl||!1;var n=new Date(t.timestamp);((new Date).getTime()-n.getTime())/36e5<24?(x(!0),P("Using saved credentials","info"),t.url&&(v=new c(t.url))):localStorage.removeItem("seeq_credentials")}catch(e){console.error("Failed to load saved credentials:",e),localStorage.removeItem("seeq_credentials")}}(),console.log("SqExcel Add-in Version: ".concat(h)),P("Add-in Version: ".concat(h),"info")}function y(){return w.apply(this,arguments)}function w(){return(w=g(l().m(function e(){var t,n,r,o;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null===(t=document.getElementById("seeq-url"))||void 0===t?void 0:t.value){e.n=1;break}return P("Please enter a Seeq server URL","error"),e.a(2);case 1:return P("Testing connection...","loading"),e.p=2,v=new c(n),e.n=3,v.testConnection();case 3:(r=e.v).success?(P(r.message,"success"),A(r,null),D("auth",r)):(P(r.message,"error"),q(r)),e.n=5;break;case 4:e.p=4,o=e.v,P("Connection test failed: ".concat(o),"error"),q({success:!1,message:o.toString(),error:o.toString()});case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function S(){return _.apply(this,arguments)}function _(){return(_=g(l().m(function e(){var t,n,r,o,s,a,i,u,d,g;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=null===(t=document.getElementById("seeq-url"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("seeq-access-key"))||void 0===n?void 0:n.value,i=null===(r=document.getElementById("seeq-password"))||void 0===r?void 0:r.value,u=null===(o=document.getElementById("ignore-ssl"))||void 0===o?void 0:o.checked,s&&a&&i){e.n=1;break}return P("Please fill in all required fields","error"),e.a(2);case 1:return P("Authenticating...","loading"),e.p=2,v||(v=new c(s)),e.n=3,v.authenticate(a,i,"Seeq",u);case 3:(d=e.v).success?(P("Authentication successful","success"),R(s,a,i,u),x(!0),D("auth",d)):P(d.message,"error"),e.n=5;break;case 4:e.p=4,g=e.v,P("Authentication failed: ".concat(g),"error");case 5:return e.a(2)}},e,null,[[2,4]])}))).apply(this,arguments)}function b(){return k.apply(this,arguments)}function k(){return(k=g(l().m(function e(){var t,n,r,o,s;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value){e.n=1;break}return P("Please enter sensor names to search for","error"),e.a(2);case 1:if(0!==(r=n.split(",").map(function(e){return e.trim()}).filter(function(e){return e})).length){e.n=2;break}return P("Please enter valid sensor names","error"),e.a(2);case 2:if(P("Searching for sensors...","loading"),e.p=3,v){e.n=4;break}return P("Please test connection first","error"),e.a(2);case 4:return e.n=5,v.searchSensors(r);case 5:(o=e.v).success?(P("Found ".concat(o.sensor_count," sensors"),"success"),D("search",o),C(o.search_results)):P(o.message,"error"),e.n=7;break;case 6:e.p=6,s=e.v,P("Sensor search failed: ".concat(s),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function E(){return T.apply(this,arguments)}function T(){return(T=g(l().m(function e(){var t,n,r,o,s,a,i,c,u,d,g,h;return l().w(function(e){for(;;)switch(e.p=e.n){case 0:if(s=null===(t=document.getElementById("sensor-names"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("start-time"))||void 0===n?void 0:n.value,i=null===(r=document.getElementById("end-time"))||void 0===r?void 0:r.value,c=null===(o=document.getElementById("grid-interval"))||void 0===o?void 0:o.value,s&&a&&i){e.n=1;break}return P("Please fill in all required fields","error"),e.a(2);case 1:if(u=s.split(",").map(function(e){return e.trim()}).filter(function(e){return e}),d=c||"15min",0!==u.length){e.n=2;break}return P("Please enter valid sensor names","error"),e.a(2);case 2:if(P("Pulling sensor data...","loading"),e.p=3,v){e.n=4;break}return P("Please test connection first","error"),e.a(2);case 4:return e.n=5,v.searchAndPullSensors(u,a,i,d);case 5:(g=e.v).success?(P("Retrieved data for ".concat(g.sensor_count," sensors"),"success"),D("data",g),I(g)):P(g.message,"error"),e.n=7;break;case 6:e.p=6,h=e.v,P("Data retrieval failed: ".concat(h),"error");case 7:return e.a(2)}},e,null,[[3,6]])}))).apply(this,arguments)}function O(){localStorage.removeItem("seeq_credentials"),v&&v.logout(),x(!1),P("Logged out successfully","info"),document.getElementById("seeq-url").value="",document.getElementById("seeq-access-key").value="",document.getElementById("seeq-password").value="",document.getElementById("ignore-ssl").checked=!1}function P(e,t){var n=document.getElementById("auth-status");n&&(n.textContent=e,n.className="auth-status ".concat(t))}function x(e){var t=document.getElementById("test-connection"),n=document.getElementById("authenticate"),r=document.getElementById("logout"),o=document.getElementById("seeq-url"),s=document.getElementById("seeq-access-key"),a=document.getElementById("seeq-password"),i=document.getElementById("ignore-ssl");e?(t.style.display="none",n.style.display="none",r.style.display="inline-block",o.disabled=!0,s.disabled=!0,a.disabled=!0,i.disabled=!0):(t.style.display="inline-block",n.style.display="inline-block",r.style.display="none",o.disabled=!1,s.disabled=!1,a.disabled=!1,i.disabled=!1)}function R(e,t,n,r){var o={url:e,accessKey:t,password:n,ignoreSsl:r,timestamp:(new Date).toISOString()};localStorage.setItem("seeq_credentials",JSON.stringify(o))}function D(e,t){try{var n=JSON.stringify(t),r='=SEEQ_UPDATE_CACHE("'.concat(e,"\", '").concat(n,"')");Excel.run(function(){var e=g(l().m(function e(t){return l().w(function(e){for(;;)switch(e.n){case 0:return t.workbook.worksheets.getActiveWorksheet().getRange("A1").values=[[r]],e.n=1,t.sync();case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("Could not update Excel cache automatically:",e),console.log("Manual cache update required:",r)})}catch(e){console.error("Failed to update Excel cache:",e)}}function C(e){var t=document.getElementById("search-results");if(t&&e.length>0){var n="\n      <h3>Search Results (".concat(e.length,' sensors)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Original Name</th>\n              <th>Seeq Name</th>\n              <th>ID</th>\n              <th>Type</th>\n              <th>Status</th>\n            </tr>\n          </thead>\n          <tbody>\n    ');e.forEach(function(e){n+="\n        <tr>\n          <td>".concat(e.Original_Name||e.Name||"N/A","</td>\n          <td>").concat(e.Name||"N/A","</td>\n          <td>").concat(e.ID||"Not Found","</td>\n          <td>").concat(e.Type||"N/A","</td>\n          <td>").concat(e.Status||"Unknown","</td>\n        </tr>\n      ")}),n+="\n          </tbody>\n        </table>\n      </div>\n    ",t.innerHTML=n}}function I(e){var t=document.getElementById("data-results");if(t&&e.data&&e.data.length>0){var n=e.data.slice(0,10),r="\n      <h3>Data Results (".concat(e.data.length,' rows)</h3>\n      <div class="results-table">\n        <table>\n          <thead>\n            <tr>\n              <th>Timestamp</th>\n              ').concat(e.data_columns.map(function(e){return"<th>".concat(e,"</th>")}).join(""),"\n            </tr>\n          </thead>\n          <tbody>\n    ");n.forEach(function(t){r+="\n        <tr>\n          <td>".concat(t.Timestamp||t.index||"N/A","</td>\n          ").concat(e.data_columns.map(function(e){return"<td>".concat(void 0!==t[e]?t[e]:"N/A","</td>")}).join(""),"\n        </tr>\n      ")}),r+="\n          </tbody>\n        </table>\n        ".concat(e.data.length>10?"<p><em>Showing first 10 of ".concat(e.data.length," rows</em></p>"):"","\n      </div>\n    "),t.innerHTML=r}}function A(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=document.getElementById("diagnostics");if(r){var o=null===(t=v)||void 0===t?void 0:t.getDiagnostics();if(o){var s='\n    <div class="diagnostics-panel">\n      <h3>🔍 Connection Diagnostics</h3>\n      <div class="diagnostic-section">\n        <h4>Environment Information</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>App Domain:</strong> '.concat(o.environment.appDomain,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Origin:</strong> ').concat(o.environment.origin,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Network Type:</strong> ').concat(o.environment.networkInfo.connectionType,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>Online Status:</strong> ').concat(o.environment.networkInfo.online?"✅ Online":"❌ Offline","\n          </div>\n        </div>\n      </div>\n  ");if(e.diagnostics&&(s+='\n      <div class="diagnostic-section">\n        <h4>Connection Test Results</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>Response Time:</strong> '.concat(e.diagnostics.request_timing,'ms\n          </div>\n          <div class="diagnostic-item">\n            <strong>Status Code:</strong> ').concat(e.status_code,'\n          </div>\n          <div class="diagnostic-item">\n            <strong>CORS Status:</strong> ').concat(e.diagnostics.cors_status,"\n          </div>\n        </div>\n    "),e.diagnostics.response_headers&&(s+='\n        <div class="cors-headers">\n          <h5>CORS Headers:</h5>\n          <ul>\n      ',["access-control-allow-origin","access-control-allow-methods","access-control-allow-headers","access-control-allow-credentials"].forEach(function(t){var n=e.diagnostics.response_headers[t];s+="<li><strong>".concat(t,":</strong> ").concat(n||"Not set","</li>")}),s+="</ul></div>"),s+="</div>"),n&&n.diagnostics){if(s+='\n      <div class="diagnostic-section">\n        <h4>Authentication Endpoint Test</h4>\n        <div class="diagnostic-grid">\n          <div class="diagnostic-item">\n            <strong>Response Time:</strong> '.concat(n.diagnostics.request_timing,'ms\n          </div>\n          <div class="diagnostic-item">\n            <strong>Status Code:</strong> ').concat(n.status_code,"\n          </div>\n        </div>\n    "),n.diagnostics.cors_analysis){var a=n.diagnostics.cors_analysis;s+='\n        <div class="cors-analysis">\n          <h5>CORS Configuration Analysis:</h5>\n          <div class="cors-status">\n            <div class="cors-item '.concat(a.allowsOrigin?"success":"error",'">\n              <strong>Origin Allowed:</strong> ').concat(a.allowsOrigin?"✅ Yes":"❌ No",'\n            </div>\n            <div class="cors-item ').concat(a.allowsMethods?"success":"error",'">\n              <strong>Methods Allowed:</strong> ').concat(a.allowsMethods?"✅ Yes":"❌ No",'\n            </div>\n            <div class="cors-item ').concat(a.allowsHeaders?"success":"error",'">\n              <strong>Headers Allowed:</strong> ').concat(a.allowsHeaders?"✅ Yes":"❌ No","\n            </div>\n          </div>\n      "),a.issues.length>0&&(s+='\n          <div class="cors-issues">\n            <h6>Issues Found:</h6>\n            <ul>\n              '.concat(a.issues.map(function(e){return"<li>❌ ".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        ")),a.recommendations.length>0&&(s+='\n          <div class="cors-recommendations">\n            <h6>Recommendations:</h6>\n            <ul>\n              '.concat(a.recommendations.map(function(e){return"<li>💡 ".concat(e,"</li>")}).join(""),"\n            </ul>\n          </div>\n        ")),s+="</div>"}s+="</div>"}o.recentLogs&&o.recentLogs.length>0&&(s+='\n      <div class="diagnostic-section">\n        <h4>Recent Diagnostic Logs</h4>\n        <div class="log-entries">\n    ',o.recentLogs.slice(-10).forEach(function(e){var t=new Date(e.timestamp).toLocaleTimeString();s+='\n        <div class="log-entry">\n          <span class="log-time">'.concat(t,'</span>\n          <span class="log-category">[').concat(e.category,']</span>\n          <span class="log-message">').concat(e.message,"</span>\n        </div>\n      ")}),s+="</div></div>"),s+='\n      <div class="diagnostic-actions">\n        <button onclick="clearDiagnostics()" class="btn-secondary">Clear Logs</button>\n        <button onclick="exportDiagnostics()" class="btn-secondary">Export Diagnostics</button>\n      </div>\n    </div>\n  ',r.innerHTML=s}}}function q(e){var t,n=document.getElementById("diagnostics");if(n){var r=null===(t=v)||void 0===t?void 0:t.getDiagnostics();if(r){var o='\n    <div class="diagnostics-panel error">\n      <h3>❌ Error Diagnostics</h3>\n      <div class="error-summary">\n        <h4>Error Summary</h4>\n        <div class="error-details">\n          <div class="error-item">\n            <strong>Error Message:</strong> '.concat(e.message,'\n          </div>\n          <div class="error-item">\n            <strong>Error Type:</strong> ').concat(e.error||"Unknown","\n          </div>\n        </div>\n      </div>\n  ");if(e.diagnostics&&e.diagnostics.error_analysis){var s=e.diagnostics.error_analysis;o+='\n      <div class="diagnostic-section">\n        <h4>Error Analysis</h4>\n        <div class="error-analysis">\n          <div class="analysis-item">\n            <strong>Error Type:</strong> '.concat(s.errorType,'\n          </div>\n          <div class="analysis-item">\n            <strong>Likely Cause:</strong> ').concat(s.likelyCause,'\n          </div>\n          <div class="analysis-flags">\n            <div class="flag ').concat(s.isCorsRelated?"active":"",'">CORS Related</div>\n            <div class="flag ').concat(s.isNetworkRelated?"active":"",'">Network Related</div>\n            <div class="flag ').concat(s.isSslRelated?"active":"",'">SSL Related</div>\n            <div class="flag ').concat(s.isAppDomainRelated?"active":"",'">AppDomain Related</div>\n          </div>\n        </div>\n    '),s.recommendations.length>0&&(o+='\n        <div class="recommendations">\n          <h5>Recommendations:</h5>\n          <ul>\n            '.concat(s.recommendations.map(function(e){return"<li>💡 ".concat(e,"</li>")}).join(""),"\n          </ul>\n        </div>\n      ")),o+="</div>"}o+='\n    <div class="diagnostic-section">\n      <h4>Environment Information</h4>\n      <div class="diagnostic-grid">\n        <div class="diagnostic-item">\n          <strong>App Domain:</strong> '.concat(r.environment.appDomain,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Origin:</strong> ').concat(r.environment.origin,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Network Type:</strong> ').concat(r.environment.networkInfo.connectionType,'\n        </div>\n        <div class="diagnostic-item">\n          <strong>Online Status:</strong> ').concat(r.environment.networkInfo.online?"✅ Online":"❌ Offline","\n        </div>\n      </div>\n    </div>\n  "),o+='\n    <div class="diagnostic-actions">\n      <button onclick="clearDiagnostics()" class="btn-secondary">Clear Logs</button>\n      <button onclick="exportDiagnostics()" class="btn-secondary">Export Diagnostics</button>\n    </div>\n  </div>\n  ',n.innerHTML=o}}}Office.onReady(g(l().m(function e(){var t,n;return l().w(function(e){for(;;)switch(e.n){case 0:return t=document.getElementById("sideload-msg"),n=document.getElementById("app-body"),t&&(t.style.display="none"),n&&(n.style.display="flex"),e.n=1,p();case 1:m();case 2:return e.a(2)}},e)}))),window.clearDiagnostics=function(){v&&v.clearDiagnostics();var e=document.getElementById("diagnostics");e&&(e.innerHTML='<div class="diagnostics-panel"><p>Diagnostics cleared. Run a connection test to generate new diagnostics.</p></div>')},window.exportDiagnostics=function(){if(v){var e=v.getDiagnostics(),t={timestamp:(new Date).toISOString(),diagnostics:e,userAgent:navigator.userAgent,url:window.location.href},n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download="sqexcel-diagnostics-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}}}(),new URL(n(98362),n.b)}();
//# sourceMappingURL=taskpane.js.map