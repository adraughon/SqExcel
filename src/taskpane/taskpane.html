<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SqExcel Add-in</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- Tailwind CSS (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- CSS will be injected by webpack -->
</head>

<body class="bg-gray-50 text-gray-800">
    <header class="flex items-center gap-3 p-4 border-b border-gray-200 bg-white">
        <img width="48" height="48" src="../../assets/logo-filled.png" alt="SqExcel" title="SqExcel" class="rounded" />
        <div class="flex-1">
            <h1 class="text-xl font-semibold leading-tight">SqExcel</h1>
            <p class="text-sm text-gray-500">Excel add-in for fast, reliable Seeq data access</p>
        </div>
        <div class="text-right">
            <span id="version-display" class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded font-mono"></span>
        </div>
    </header>

    <section id="sideload-msg" class="p-4">
        <h2 class="text-base">Please <a class="text-indigo-600 underline" target="_blank" href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a> your add-in to see app body.</h2>
    </section>

    <main id="app-body" style="display: none;" class="p-4 flex flex-col gap-6 w-full">
        <!-- Cards Container -->
        <div class="cards space-y-6">
            <!-- Seeq Auth Card -->
            <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm w-full">
                <h3 class="text-lg font-medium mb-3">Seeq Authentication</h3>
                <div class="grid grid-cols-1 gap-3">
                    <label class="block">
                        <span class="text-sm text-gray-700">Seeq Server URL</span>
                        <input type="url" id="seeq-url" placeholder="https://your-server.seeq.site" class="mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm" />
                    </label>
                    <label class="block">
                        <span class="text-sm text-gray-700">Access Key</span>
                        <input type="text" id="seeq-access-key" placeholder="Your Seeq access key" class="mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm" />
                    </label>
                    <label class="block">
                        <span class="text-sm text-gray-700">Password</span>
                        <input type="password" id="seeq-password" placeholder="Your Seeq password" class="mt-1 w-full rounded-md border border-gray-300 bg-white px-3 py-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm" />
                    </label>
                    <div class="flex items-center gap-2 pt-1 flex-wrap">
                        <button id="authenticate" class="px-3 py-1.5 text-sm text-white rounded-md hover:opacity-95" style="background-color: #55924C;">Authenticate</button>
                        <button id="logout" class="px-3 py-1.5 text-sm bg-gray-100 text-gray-800 rounded-md hover:bg-gray-200" style="display: none;">Logout</button>
                    </div>
                </div>
                <div id="auth-status" class="mt-2 text-sm"></div>
            </div>

            <!-- Getting Started Card -->
            <div id="diagnostics" class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm w-full">
                <h3 class="text-xl font-semibold mb-6 text-gray-800">Getting Started</h3>
                
                <!-- Setup Steps -->
                <div class="mb-8">
                    <h4 class="text-lg font-semibold mb-6 text-gray-800">Setup Authentication</h4>
                    
                    <div class="space-y-6">
                        <div class="flex items-start gap-4">
                            <span class="bg-gray-200 text-gray-700 rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-1">1</span>
                            <div class="text-sm text-gray-600">
                                <p class="font-medium text-gray-700 mb-2">Create Seeq Access Key:</p>
                                <ul class="list-disc list-inside space-y-1 ml-2">
                                    <li>Go to <strong class="text-gray-800">Seeq Homepage</strong></li>
                                    <li>Click <strong class="text-gray-800">Your Profile/Name</strong> in the top right</li>
                                    <li>Click <strong class="text-gray-800">"Access Keys"</strong></li>
                                    <li>Create a new key and <strong class="text-gray-800">save the key value and secret somewhere safe</strong></li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="flex items-start gap-4">
                            <span class="bg-gray-200 text-gray-700 rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-1">2</span>
                            <div class="text-sm text-gray-600">
                                <p>Enter your <strong class="text-gray-800">Seeq server URL</strong>, <strong class="text-gray-800">Access Key</strong>, and <strong class="text-gray-800">Password</strong> in the form above</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start gap-4">
                            <span class="bg-gray-200 text-gray-700 rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold flex-shrink-0 mt-1">3</span>
                            <div class="text-sm text-gray-600">
                                <p>Click <strong class="text-gray-800">"Authenticate"</strong> to connect to your Seeq server</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Excel Functions Card -->
            <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm w-full">
                <h3 class="text-xl font-semibold mb-4 text-gray-800">Excel Functions</h3>
                
                <!-- PULL Function -->
                <div class="mb-8">
                    <div class="bg-green-100 text-green-800 rounded-lg px-3 py-1.5 mb-2 inline-block font-bold text-sm">
                        PULL
                    </div>
                    <p class="text-sm text-gray-600 mb-2 font-medium">Retrieves time series data from Seeq sensors</p>
                    <code class="text-xs text-gray-700 block mb-3 bg-gray-100 px-2 py-1 rounded">=SqExcel.PULL(sensorNames, startDatetime, endDatetime, [mode], [modeValue])</code>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Parameters:</h5>
                        <ul class="text-xs text-gray-600 space-y-1 ml-4">
                            <li><strong>sensorNames<span class="text-red-500">*</span>:</strong> Range containing sensor names</li>
                            <li><strong>startDatetime<span class="text-red-500">*</span>:</strong> Start time as text</li>
                            <li><strong>endDatetime<span class="text-red-500">*</span>:</strong> End time as text</li>
                            <li><strong>mode:</strong> "points" or "grid" (default: "points")</li>
                            <li><strong>modeValue:</strong> Number of points or time interval (default: 1000)</li>
                        </ul>
                    </div>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Examples:</h5>
                        <div class="space-y-1">
                            <code class="bg-gray-100 px-2 py-1 block text-xs font-mono text-gray-800 rounded">=SqExcel.PULL(A1:C1, "8/1/2025 0:00", "8/2/2025 0:00")</code>
                            <code class="bg-gray-100 px-2 py-1 block text-xs font-mono text-gray-800 rounded">=SqExcel.PULL(A1:C1, "8/1/2025 0:00", "8/2/2025 0:00", "grid", "15min")</code>
                        </div>
                    </div>
                    
                    <p class="text-xs text-gray-600"><strong>Returns:</strong> Time series data with timestamps and sensor values</p>
                </div>

                <!-- CURRENT Function -->
                <div class="mb-8">
                    <div class="bg-blue-100 text-blue-800 rounded-lg px-3 py-1.5 mb-2 inline-block font-bold text-sm">
                        CURRENT
                    </div>
                    <p class="text-sm text-gray-600 mb-2 font-medium">Gets the current value of a single sensor</p>
                    <code class="text-xs text-gray-700 block mb-3 bg-gray-100 px-2 py-1 rounded">=SqExcel.CURRENT(sensorName)</code>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Parameters:</h5>
                        <ul class="text-xs text-gray-600 space-y-1 ml-4">
                            <li><strong>sensorName<span class="text-red-500">*</span>:</strong> Single sensor name as text</li>
                        </ul>
                    </div>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Examples:</h5>
                        <code class="bg-gray-100 px-2 py-1 block text-xs font-mono text-gray-800 rounded">=SqExcel.CURRENT("A1_Pressure")</code>
                    </div>
                    
                    <p class="text-xs text-gray-600"><strong>Returns:</strong> Current scalar value</p>
                </div>

                <!-- AVERAGE Function -->
                <div class="mb-8">
                    <div class="bg-purple-100 text-purple-800 rounded-lg px-3 py-1.5 mb-2 inline-block font-bold text-sm">
                        AVERAGE
                    </div>
                    <p class="text-sm text-gray-600 mb-2 font-medium">Calculates average value over a time range</p>
                    <code class="text-xs text-gray-700 block mb-3 bg-gray-100 px-2 py-1 rounded">=SqExcel.AVERAGE(sensorName, startDatetime, endDatetime)</code>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Parameters:</h5>
                        <ul class="text-xs text-gray-600 space-y-1 ml-4">
                            <li><strong>sensorName<span class="text-red-500">*</span>:</strong> Single sensor name as text</li>
                            <li><strong>startDatetime<span class="text-red-500">*</span>:</strong> Start time as text</li>
                            <li><strong>endDatetime<span class="text-red-500">*</span>:</strong> End time as text</li>
                        </ul>
                    </div>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Examples:</h5>
                        <code class="bg-gray-100 px-2 py-1 block text-xs font-mono text-gray-800 rounded">=SqExcel.AVERAGE("B3-Speed.PV", "8/1/2025 0:00", "8/1/2025 1:00")</code>
                    </div>
                    
                    <p class="text-xs text-gray-600"><strong>Returns:</strong> Average value over 100 data points</p>
                </div>

                <!-- CREATE_PLOT_CODE Function -->
                <div class="mb-8">
                    <div class="bg-orange-100 text-orange-800 rounded-lg px-3 py-1.5 mb-2 inline-block font-bold text-sm">
                        CREATE_PLOT_CODE
                    </div>
                    <p class="text-sm text-gray-600 mb-2 font-medium">Generates Python matplotlib code for plotting sensor data</p>
                    <code class="text-xs text-gray-700 block mb-3 bg-gray-100 px-2 py-1 rounded">=SqExcel.CREATE_PLOT_CODE(sensorNames, startDatetime, endDatetime, [points], [height], [aspectRatio], [showLine], [showPoints], [opacity], [colors], [style], [labels], [yAxisBehavior])</code>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Parameters:</h5>
                        <ul class="text-xs text-gray-600 space-y-1 ml-4">
                            <li><strong>sensorNames<span class="text-red-500">*</span>:</strong> Range with sensor names</li>
                            <li><strong>startDatetime<span class="text-red-500">*</span>:</strong> Start time as text</li>
                            <li><strong>endDatetime<span class="text-red-500">*</span>:</strong> End time as text</li>
                            <li><strong>points:</strong> Number of data points (default: 100)</li>
                            <li><strong>height:</strong> Chart height ratio (default: 0.3)</li>
                            <li><strong>aspectRatio:</strong> Width to height ratio (default: 5)</li>
                            <li><strong>showLine:</strong> Display line plot (default: true)</li>
                            <li><strong>showPoints:</strong> Display data points (default: true)</li>
                            <li><strong>opacity:</strong> Chart transparency 0-1 (default: 0.9)</li>
                            <li><strong>colors:</strong> Comma-separated colors (default: "green, red, blue")</li>
                            <li><strong>style:</strong> "sparkline", "minimal", or "normal" (default: "sparkline")</li>
                            <li><strong>labels:</strong> Comma-separated sensor labels (default: sensor names)</li>
                            <li><strong>yAxisBehavior:</strong> "share" or "split" (default: "share")</li>
                        </ul>
                    </div>
                    
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Examples:</h5>
                        <div class="space-y-1">
                            <code class="bg-gray-100 px-2 py-1 block text-xs font-mono text-gray-800 rounded">=SqExcel.CREATE_PLOT_CODE(A1:C1, "8/1/2025 0:00", "8/1/2025 1:00")</code>
                            <code class="bg-gray-100 px-2 py-1 block text-xs font-mono text-gray-800 rounded">=SqExcel.CREATE_PLOT_CODE(A1:B1, "8/1/2025", "8/2/2025", 100, 0.5, 4, TRUE, TRUE, 0.8, "green, red", "normal", "Temp, Press", "split")</code>
                        </div>
                    </div>
                    
                    <!-- Available Colors -->
                    <div class="mb-4">
                        <h5 class="text-sm font-semibold text-gray-700 mb-2">Available Colors:</h5>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-xs">
                            <!-- Colors will be dynamically generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Python Execution Guide -->
                    <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
                        <h5 class="text-sm font-semibold text-blue-800 mb-2 flex items-center">
                            <span class="mr-2">🐍</span>
                            How to Execute Python Plot Code
                        </h5>
                        <ol class="space-y-1 text-xs text-blue-700">
                            <li><strong>1.</strong> Go to an empty cell where you want the plot</li>
                            <li><strong>2.</strong> Type <code class="bg-gray-100 px-1 rounded font-mono">=PY</code> to enter Python mode</li>
                            <li><strong>3.</strong> Type <code class="bg-gray-100 px-1 rounded font-mono">exec(</code>,  and click the cell with plot code, then <code class="bg-gray-100 px-1 rounded font-mono">)</code></li>
                            <li><strong>4.</strong> Press Ctrl + Enter to execute the cell</li>
                        </ol>
                        <div class="mt-2 p-2 bg-blue-100 rounded text-xs">
                            <strong class="text-blue-800">💡 Tip:</strong> <span class="text-blue-700">If Excel shows a message like <code class="bg-gray-100 px-1 rounded font-mono">PY[Image]</code> instead of the plot, click the icon next to "PY" in the formula bar and change from "Python Object" to "Excel Value"</span>
                        </div>
                    </div>
                    
                    <p class="text-xs text-gray-600 mt-4"><strong>Returns:</strong> Complete Python matplotlib code for creating plots</p>
                </div>
            </div>

            <!-- Need Help Card -->
            <div class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm w-full">
                <h3 class="text-lg font-medium mb-3 text-gray-800">Need Help?</h3>
                <div class="text-sm text-gray-600 text-center">
                    Contact us at <a href="mailto:austin@radialflow.net" class="text-indigo-600 underline font-medium">austin@radialflow.net</a>
                </div>
            </div>
        </div>

        <p class="text-xs text-gray-500"><label id="item-subject"></label></p>
    </main>
</body>

</html>
